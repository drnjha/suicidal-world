---
title: "Suicidal World"
author: "Norbert Hartkamp, M.D., M.Sc."
date: "`r format(Sys.Date(), format='%d.%m.%Y')`"
bibliography: references.yaml
csl: apa.csl
link-citations: yes
output:
  bookdown::pdf_document2:
    header-includes:
      - \usepackage{float}
      - \usepackage{xcolor}
      - \usepackage{longtable}
    theme: spacelab
    number_sections: yes
    keep_tex: yes
    keep_md: true
    toc: yes
    toc_depth: 2
    fontsize: 10pt
    geometry: margin=30mm
    fig_caption: yes
    extra_dependencies: ["flafter"]
  bookdown::html_document2:
    css: "html-style.css"
    toc: yes
    toc_depth: 2
    number_sections: yes
    theme: spacelab
    fig_caption: yes
    keep_tex: yes
    keep_md: true
    fontsize: 10pt
---

```{=tex}
\hypersetup{colorlinks, citecolor=blue, filecolor=blue, linkcolor=blue, urlcolor=blue, pdftex}
\renewcommand{\topfraction}{.85}
\renewcommand{\bottomfraction}{.7}
\renewcommand{\textfraction}{.15}
\renewcommand{\floatpagefraction}{.66}
\setcounter{topnumber}{3}
\setcounter{bottomnumber}{3}
\setcounter{totalnumber}{4}
\newcommand{\verbatimfont}[1]{\renewcommand{\verbatim@font}{\ttfamily#1}}
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

```{css, echo=FALSE}
.small {
  font-size: 10px;
}
```

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```

# Executive Summary

An analysis is done of worldwide data on suicide rates as part of the HarvardX PH125.9x data science-course, capstone-module.

Suicide a relevant health issue that is repeatedly adressed e.g. by the WHO.

A publicly available data set from *Kaggle* being too fragmentary, a analysis data set from various sources (Our World in Data, WHO, PEW research and others) was compiled.

The time trends of suicidality in different entities (i.e. nations) were first analyzed using cluster analysis. In a second step determinants of suicidality were investigated using bi-variate and multiple correlation analysis.

The results of cluster analysis only show partial accordance with results reported in the literature.

The bi-variate and multivariate correlations show some accordance with findings from the literature, although it remains unclear, how the results are affected by a sometimes limited quality of the primary data, from which the data set for the present analysis was compiled.

# Introduction and Overview

There is little doubt among scientists [@preti2011] that the ability to intentionally end one's own life is uniquely human. Although it apparently defies the logic of evolutionary biology [@chatterjee2021] there is each year an estimated number of more than 700,000 people dying from suicide, with suicide being a leading cause of death particularly in the younger population [@ritchie2015].

Although data on suicide are published widely on the net [see @suicide], in the present analysis I attempt at describing patterns and trends in suicide data, hoping to be able to show some of the relevant patterns in a concise way. It has to noted however, that the standards of data reporting in this field are not optimal. As Bertolote & Fleischmann [-@bertolote2002] note, developed countries report these data mostly on a regular basis, while most developing countries from Latin America, Asia, and the East Mediterranean report only irregularly, and only very few countries from Africa do report on mortality to the WHO at all.

What I obviously cannot do in my data based analysis, is to focus on the existentially important questions of the psychopathology of suicidality [@kulawik1977; @modestin1990; @maltsberger2004; @little2009], the individual developmental preconditions of the development of suicidal tendencies [@hardt2007], the question how suicidal tendencies can be prevented [@taylor1997; @deleo2002; @zalsman2017; @hegerl2019], or how suicidality can or should be treated medically [@althaus2004; @hegerl2005; @wolfersdorf2008].

## R libraries being used

The following libraries will be used in the present project:

```{r installing-and-loading-missing-libs, message=FALSE, warning=FALSE, echo=FALSE}
##########################################################
# installing and loading missing libs
##########################################################
if(!require(data.table)) install.packages("data.table", repos = "http://cran.us.r-project.org")
if(!require(tidyverse)) install.packages("tidyverse", repos = "http://cran.us.r-project.org")
if(!require(RSelenium)) install.packages("RSelenium", repos = "http://cran.us.r-project.org")
if(!require(stringi)) install.packages("stringi", repos = "http://cran.us.r-project.org")
if(!require(ggthemes)) install.packages("ggthemes", repos = "http://cran.us.r-project.org")
if(!require(gridExtra)) install.packages("gridExtra", repos = "http://cran.us.r-project.org")
if(!require(viridis)) install.packages("viridis", repos = "http://cran.us.r-project.org")
if(!require(owidR)) install.packages("owidR", repos = "http://cran.us.r-project.org")
if(!require(lubridate)) install.packages("lubridate", repos = "http://cran.us.r-project.org")
if(!require(kableExtra)) install.packages("kableExtra", repos = "http://cran.us.r-project.org")
if(!require(psych)) install.packages("psych", repos = "http://cran.us.r-project.org")
if(!require(latex2exp)) install.packages("latex2exp", repos = "http://cran.us.r-project.org")
if(!require(rvest)) install.packages("rvest", repos = "http://cran.us.r-project.org")
if(!require(pdftools)) install.packages("pdftools", repos = "http://cran.us.r-project.org")
if(!require(openxlsx)) install.packages("openxlsx", repos = "http://cran.us.r-project.org")
if(!require(readxl)) install.packages("readxl", repos = "http://cran.us.r-project.org")
if(!require(fpc)) install.packages("fpc", repos = "http://cran.us.r-project.org")
if(!require(TSclust)) install.packages("TSclust", repos = "http://cran.us.r-project.org")
if(!require(factoextra)) install.packages("factoextra", repos = "http://cran.us.r-project.org")
if(!require(hopkins)) install.packages("hopkins", repos = "http://cran.us.r-project.org") 
if(!require(clValid)) install.packages("clValid", repos = "http://cran.us.r-project.org")
if(!require(ggpubr)) install.packages("ggpubr", repos = "http://cran.us.r-project.org")
if(!require(compiler)) install.packages("compiler", repos = "http://cran.us.r-project.org")
###############################################################
# for simplicity's sake: loading the necessary data from github
###############################################################
download.file("https://github.com/drnjha/suicidal-world/raw/main/suicide-data-analysis.zip", "./suicide-data-analysis.zip")
unzip("./suicide-data-analysis.zip")
```

```{r loading-libs, message=FALSE}
library(knitr)
library(data.table)
library(tidyverse)
library(RSelenium)
library(stringi)
library(ggthemes)
library(gridExtra)
library(viridis)
library(owidR)
library(lubridate)
library(kableExtra)
library(psych)
library(latex2exp)
library(rvest)
library(pdftools)
library(openxlsx)
library(readxl)
library(fpc)
library(TSclust)
library(factoextra)
library(hopkins)
library(clValid)
library(ggpubr)
library(compiler)
```

```{r useful-functions, echo=FALSE, results = 'hide', message=FALSE}
fancy_scientific <- function(l) {
 # turn in to character string in scientific notation
 l <- format(l, scientific = TRUE)
 # quote the part before the exponent to keep all the digits
 l <- gsub("^(.*)e", "'\\1'e", l)
 # turn the 'e+' into plotmath format
 l <- gsub("e", "%*%10^", l)
 # return this as an expression
 parse(text=l)
}

setCompilerOptions(optimize=3)
enableJIT(3)

getOutputFormat <- function() {
  output <- rmarkdown:::parse_yaml_front_matter(
    readLines(knitr::current_input())
    )$output
  if (is.list(output)){
    return(names(output)[1])
  } else {
    return(output[1])
  }
}

if(getOutputFormat() == 'pdf_document2') {
   # do something
}
if(getOutputFormat() == 'html_document2') {
   # do something
}

minmax <- function(df) {c(min(df), max(df))}

Mode <- function(x) {           # https://stackoverflow.com/questions/2547402/how-to-find-the-statistical-mode
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}

#Fork of https://github.com/ateucher/useful_code/blob/master/R/numbers2words.r
#https://gist.githubusercontent.com/hack-r/22104543e2151519c41a8f0ce042b31c/raw/01731f3176b4ee471785639533d38eda4790ab77/numbers2words.r
numbers2words <- function(x){
  ## Function by John Fox found here: 
  ## http://tolstoy.newcastle.edu.au/R/help/05/04/2715.html
  ## Tweaks by AJH to add commas and "and"
  if(x==0){
     print( "zero")
    } else{
    helper <- function(x){
      
      digits <- rev(strsplit(as.character(x), "")[[1]])
      nDigits <- length(digits)
      if (nDigits == 1) as.vector(ones[digits])
      else if (nDigits == 2)
        if (x <= 19) as.vector(teens[digits[1]])
      else trim(paste(tens[digits[2]],
                      Recall(as.numeric(digits[1]))))
      else if (nDigits == 3) trim(paste(ones[digits[3]], "hundred and", 
                                        Recall(makeNumber(digits[2:1]))))
      else {
        nSuffix <- ((nDigits + 2) %/% 3) - 1
        if (nSuffix > length(suffixes)) stop(paste(x, "is too large!"))
        trim(paste(Recall(makeNumber(digits[
          nDigits:(3*nSuffix + 1)])),
          suffixes[nSuffix],"," ,
          Recall(makeNumber(digits[(3*nSuffix):1]))))
      }
    }
    trim <- function(text){
      #Tidy leading/trailing whitespace, space before comma
      text=gsub("^\ ", "", gsub("\ *$", "", gsub("\ ,",",",text)))
      #Clear any trailing " and"
      text=gsub(" and$","",text)
      #Clear any trailing comma
      gsub("\ *,$","",text)
    }  
    makeNumber <- function(...) as.numeric(paste(..., collapse=""))     
    #Disable scientific notation
    opts <- options(scipen=100) 
    on.exit(options(opts)) 
    ones <- c("", "one", "two", "three", "four", "five", "six", "seven",
              "eight", "nine") 
    names(ones) <- 0:9 
    teens <- c("ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen",
               "sixteen", " seventeen", "eighteen", "nineteen")
    names(teens) <- 0:9 
    tens <- c("twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty",
              "ninety") 
    names(tens) <- 2:9 
    x <- round(x)
    suffixes <- c("thousand", "million", "billion", "trillion")     
    if (length(x) > 1) return(trim(sapply(x, helper)))
    helper(x)    
  }

}
```

```{r, Compute_clusters_Within_Cluster_Sum_of_Squares, echo=FALSE, warnings=FALSE, message=FALSE}
# from: https://rdrr.io/github/sarafrr/basicClEval/man/wcss.html
#' Compute centroids
#'
#' This function computes the centroids for each cluster.
#' It takes in input a data.frame or a matrix of data and a vector
#' containing the classification of each sample.
#'
#' @param data Dataset of class type data.frame or matrix
#' @param clClassification Vector of samples' clustering labels
#' @param ... Other arguments
#' @return A list with:\cr
#' * clCentres - data frame of means nClustersxncol(data)
#' * nClusters - number of clusters
#' * sizeCl - number of elements by cluster
#' @export
clMeans <- function(data,clClassification,verbose=TRUE,... ) {
  if(is.matrix(data)){
    mat <-data
    df <- as.data.frame(mat)
  }else if(is.data.frame(data)){
    df <- data
    mat<-as.matrix(data)
  }else{
    if(verbose){
      cat("The data has to be a matrix or a dataframe\n",sep="")
    }
    stop()
  }
  if(nrow(mat)!=length(clClassification)){
    if(verbose){
      cat("The classification vector length (",length(clClassification),
          ") differs from the number of observation in the dataset (",nrow(mat),") \n",sep="")
    }
    stop()
  }else{
    sizeCl <- summary(as.factor(clClassification))
    clCenters <- tapply(mat, list(rep(clClassification,ncol(mat)),col(mat)),
                      function(x) mean(x, na.rm=TRUE))
    clCenters <- as.data.frame(clCenters)
    clCenters <- setNames(clCenters, names(df))
  }
  nClusters = nlevels(as.factor(clClassification))
  list(
    clCenters=clCenters,
    nClusters=nClusters,
    sizeCl=sizeCl
  )
}

#' Compute clusters' variances
#'
#' This function computes the inner variance for each cluster.
#' It takes in input a data.frame or a matrix of data and a vector
#' containing the classification of each sample.
#'
#' @param data Dataset of class type data.frame or matrix
#' @param clClassification Vector of samples' clustering labels
#' @param ... Other arguments
#' @return A list with:\cr
#' * clVariances - data frame of variances nClustersxncol(data)
#' * nClusters - number of clusters
#' * sizeCl - number of elements by cluster
#' @export
clInnerVariances <- function(data,clClassification,verbose=TRUE,... ) {
  if(is.matrix(data)){
    mat <-data
    df <- as.data.frame(mat)
  }else if(is.data.frame(data)){
    df <- data
    mat<-as.matrix(data)
  }else{
    if(verbose){
      cat("The data has to be a matrix or a dataframe\n",sep="")
    }
    stop()
  }
  if(nrow(mat)!=length(clClassification)){
    if(verbose){
      cat("The classification vector length (",length(clClassification),
          ") differs from the number of observation in the dataset (",nrow(mat),") \n",sep="")
    }
    stop()
  }else{
    sizeCl <- summary(as.factor(clClassification))
    clVariances <- tapply(mat, list(rep(clClassification,ncol(mat)),col(mat)),
                        function(x) var(x, na.rm=TRUE))
    clVariances <- as.data.frame(clVariances)
    clVariances <- setNames(clVariances, names(df))
  }
  nClusters = nlevels(as.factor(clClassification))
  list(
    clVariances=clVariances,
    nClusters=nClusters,
    sizeCl=sizeCl
  )
}

#' Compute clusters' Within Cluster Sum of Squares
#'
#' This function computes the Within Cluster Sum of Squares WCSS for each cluster.
#' It takes in input a data.frame or a matrix of data and a vector
#' containing the classification of each sample.
#'
#' @param data Dataset of class type data.frame or matrix
#' @param clClassification Vector of samples' clustering labels
#' @param ... Other arguments
#' @return A list with:\cr
#' * WCSSByClByVar - WCSS by cluster by variable
#' * WCSSByClB - WCSS by cluster
#' * WCSS - Sum of the total WCSS
#' * nClusters - number of clusters
#' * sizeCl - number of elements by cluster
#' @export
wcss <- function(data,clClassification,verbose=TRUE,... ) {
  if(is.matrix(data)){
    mat <-data
    df <- as.data.frame(mat)
  }else if(is.data.frame(data)){
    df <- data
    mat<-as.matrix(data)
  }else{
    if(verbose){
      cat("The data has to be a matrix or a dataframe\n",sep="")
    }
    stop()
  }
  if(nrow(mat)!=length(clClassification)){
    if(verbose){
      cat("The classification vector length (",length(clClassification),
          ") differs from the number of observation in the dataset (",nrow(mat),") \n",sep="")
    }
    stop()
  }else{
    sizeCl <- summary(as.factor(clClassification))
    WCSSByClByVar <- tapply(mat, list(rep(clClassification,ncol(mat)),col(mat)),
                          function(x) var(x, na.rm=TRUE)*(length(x)-1))
    WCSSByClByVar <- as.data.frame(WCSSByClByVar)
    WCSSByClByVar <- setNames(WCSSByClByVar, names(df))
    WCSSByCl <- rowSums(WCSSByClByVar)
    WCSS <- sum(WCSSByCl)
  }
  nClusters = nlevels(as.factor(clClassification))
  list(
    WCSSByClByVar=WCSSByClByVar,
    WCSSByCl = WCSSByCl,
    WCSS = WCSS,
    nClusters=nClusters,
    sizeCl=sizeCl
  )
}

#' Prints the information of an object returned by wcss
#'
#' This function prints all the information contained into [wcss]
#' It takes in input an object returned by [wcss]
#'
#' @param x Object returned by [wcss] function
#' @param ... Other arguments
#' @return A print with a brief explanation of:\cr
#' * WCSSByClByVar - WCSS by cluster by variable
#' * WCSSByClB - WCSS by cluster
#' * WCSS - Sum of the total WCSS
#' * nClusters - number of clusters
#' * sizeCl - number of elements by cluster
#' @export
print.wcss <- function(x,...){
  cat("\nWithin Cluster Sum of Squares by cluster by variable:\n")
  print(x$WCSSByClByVar, ...)
  cat("\nWithin Cluster Sum of Squares by cluster:\n")
  print(x$WCSSByCl, ...)
  cat("\nNumber of clusters:\n")
  print(x$nClusters, ...)
  cat("\nNumber of elements by cluster:\n")
  print(x$sizeCl, ...)
  cat("\nAvailable components:\n")
  print(names(x))
  # print the object itself by calling the assigned variable
  # instead of printing the last string
  invisible(x)
}
```

## Data ingestion

The data on which the present analysis is based are provided by [Kaggle](https://www.kaggle.com/), which since 2017 is a subsidiary of [Google](https://www.google.com). As a corresponding [Wikipedia article](https://en.wikipedia.org/wiki/Kaggle) states, it is the aim of Kaggle to provide users, mainly data scientists and machine learning practitioners, a platform from which publicly available data can be downloaded to do data analyses, which then even can be subject to a competition of multiple users over who does data analysis best. However, the present analysis does not attempt to be part of such an endeavor, but is part of the fulfillment of the requirements of the HarvardX PH125.9x course on Data Science.

The data used in the present analysis can be found under the heading of [Suicide Rates Overview 1985 to 2016](https://www.kaggle.com/datasets/russellyates88/suicide-rates-overview-1985-to-2016) on the Kaggle website as a [zipped](https://www.kaggle.com/datasets/russellyates88/suicide-rates-overview-1985-to-2016/download?datasetVersionNumber=1) comma separated file.

```{r data_preparation, echo=FALSE, warning=FALSE}
suicideraw <- read.csv("master.csv")
```

# Methods

The methods I'll be using are first and foremost *descriptive*. Furthermore, I will try to illustrate the data with geographical and statistical figures. I'll also use classification methods, and methods to reduce complexity. Where possible and appropriate, I will attempt to make connections between the data on suicide incidence and other relevant data that are publicly available.

# Describing the *Kaggle*-data

In the *Kaggle*-data read in from the CSV-file there are a total of `r prettyNum(nrow(suicideraw), big.mark=",")` entries, each comprising of `r ncol(suicideraw)` variables. The variables are:

(1) **country** with *`r length(unique(suicideraw$country))`* alphabetically sorted entries ranging from *`r min(suicideraw$country)`* to *`r max(suicideraw$country)`*,\
(2) **year** ranging from *`r min(suicideraw$year)`* to *`r max(suicideraw$year)`*,\
(3) **sex** with the two entries *`r unique(suicideraw$sex)[1]`* and *`r unique(suicideraw$sex)[2]`*,\
(4) **age**, where ages are grouped in the different classes `r a <- unique(suicideraw$age) %>% str_replace_all(" years", ""); num <- as.numeric(sub("([0-9]+).*", "\\1", a)); a <- a[order(num)]; a <- c("*", paste(a, collapse="*, *"), "*"); paste(a, collapse="")` years,\
(5) **suicides_no** indicating the number of suicides in the respective subgroup (country, year, sex, age-group),\
(6) **population** indicating the population size in the respective subgroup,\
(7) **suicides.100k.pop** suicide rate standardized per population size of 100,000\
(8) **country.year** indicating country and year, an aggregated variable following the pattern *Nnnnnnnnnnyyyy*, which might be useful for grouping the data\
(9) **HDI.for.year** with the Human Development Index being "a summary measure of average achievement in key dimensions of human development" [@nations]\
(10) **gdp_for_year** indicating the Gross Domestic Product for the respective country and year\
(11) **gdp_per_capita** indicating the GDP per person for the respective country and year\
(12) **generation** a characterization of "generations" according to an age-group (which may or may not be useful in discussing worldwide data from different cultural backgrounds). The terms used here are `r stri_replace_last_fixed(paste(c("*",paste(unique(suicideraw$generation), collapse="*, *"),"*"), collapse=""), ', ', ', and ')`.

## General Overview

Over the whole time span covered by the data, there were a number of `r prettyNum(suicideraw$suicides_no %>% sum(), big.mark=",")` suicides reported. The mean annual number of which ($\overline{m}$ = `r prettyNum(suicideraw %>% group_by(year) %>% summarize(annual_suicide_no=sum(suicides_no)) %>% summarize(m=mean(annual_suicide_no)) %>% as.numeric() , big.mark=",")`) is showing a sharp decline (as shown in fig. \@ref(fig:AvgSuicidesPerYear)) in the last reported year `r max(suicideraw$year)`, which most likely is due to an incompleteness of the data from that year. As a consequence the data from year `r max(suicideraw$year)` are being excluded from the further analysis. Also the lower numbers from before 1990 might indicate an incompleteness of data related to the countries of the former *Eastern Europe* and the *Soviet Union* having not provided their suicide data.

```{r AvgSuicidesPerYear, warning=F, message=F, echo=F, fig.cap="average number of suicides per year", out.width = ".7\\textwidth", fig.align="left", wrapfigure = list("L", .7)}
suicideraw %>% group_by(year) %>% summarize(annual_suicide_no=sum(suicides_no)) %>% ggplot(aes(x=year, y=annual_suicide_no)) + geom_bar(stat='identity') + labs(x = "year", y = "count of suicides") + scale_y_continuous(labels=fancy_scientific)
suicideraw <- suicideraw[which(suicideraw$year != "2016"), ]
```

The following fig. \@ref(fig:AvgSuicidesPerYearInRF) shows that for the *Russian Federation* there are no data from before 1989 (when the *Soviet Union* still existed), and there is also no country *Soviet Union* in the *countries* list.

The same applies to *Germany*, where no data from before 1990 (year of German unification) are found in the [Kaggle](https://www.kaggle.com/datasets/russellyates88/suicide-rates-overview-1985-to-2016/download?datasetVersionNumber=1) data set, or e.g. for *Romania* where no data exist from before 1989, which was the year of the [Romanian Revolution](https://en.wikipedia.org/wiki/Romanian_Revolution).

*Macau* is another special case: Macau was formerly a Portuguese colony, and was transferred to China in 1999 [see: @macau2022]. In the data set there are no data in suicide in China. In the case of *Macau* there are only data available for one single year (*1994*), and because of this the *Macau*-data were excluded from the further analyses.

```{r AvgSuicidesPerYearInRF, warning=F, message=F, echo=F, fig.cap="mean suicides/year in Russ. Fed. (partial view)", out.width = ".7\\textwidth", fig.align="right", wrapfigure = list("R", .7)}
suicideraw %>% filter(country == "Russian Federation" & year < 1996) %>%  group_by(year) %>% summarize(annual_suicide_no=sum(suicides_no)) %>% ggplot(aes(x=year, y=annual_suicide_no)) + geom_bar(stat='identity') + labs(x = "year", y = "count of suicides") + scale_y_continuous(labels=fancy_scientific)
suicideraw <- suicideraw[which(suicideraw$year >= "1990"), ]
suicideraw <- suicideraw[which(suicideraw$country != "Macau"),]
```

In summary, due to the incompleteness of the data, it at first seemed safe to **restrict** the analyses to the time span from **1990** to **2015**, so that the analysis would be based on `r prettyNum(nrow(suicideraw), big.mark=",")` entries in the data set.

As the following map (fig. \@ref(fig:WorldMapTotalSuicideNumbers)) shows, there are still many countries from which data are missing, which of course is a grave limitation to the analysis to be made.

```{r WorldMapTotalSuicideNumbers, message=FALSE, echo=FALSE, fig.cap="map of total suicide numbersin different countries according to kaggle ", out.width = "70%"}
##############################################################
# for each country the total suicide numbers are summed up for the whole time period under consideration
##############################################################
gross_suicides_country <- suicideraw %>% group_by(country) %>% summarise(sum_suicides_no=sum(suicides_no))

##############################################################
# the map's data are read from a variable given in ggplot2
##############################################################
world <- map_data("world")

##############################################################
# because of different designations of countries' names in the "world" and the "suicideraw" data, names have to be reworked a little
##############################################################
world[which(world$region == "Russia"),]$region                                       <- "Russian Federation"
world[which(world$region == "Cape Verde"),]$region                                   <- "Cabo Verde"
world[which(world$region == "USA"),]$region                                          <- "United States"
world[which(world$region == "UK"),]$region                                           <- "United Kingdom"
world[which(world$region == "South Korea"),]$region                                  <- "Republic of Korea"
world[which(world$region == "Antigua" | world$region == "Barbuda"),]$region          <- "Antigua and Barbuda"
world[which(world$region == "Trinidad" | world$region == "Tobago"),]$region          <- "Trinidad and Tobago"
world[which(world$region == "Saint Kitts" | world$region == "Nevis"),]$region        <- "Saint Kitts and Nevis"
world[which(world$region == "Saint Vincent" | world$region == "Grenadines"),]$region <- "Saint Vincent and Grenadines"

##############################################################
# plot the world map data
##############################################################
world %>%
  merge(gross_suicides_country, by.x = "region", by.y = "country", all.x = T) %>%
  arrange(group, order) %>%
  ggplot(aes(x = long, y = lat, group = group, fill = sum_suicides_no)) +
  geom_polygon(color = "gray90", size = 0.1) +
  scale_fill_viridis(name="total\nsuicides", option="H", begin=0.6, end=0.9, na.value = "white", labels = fancy_scientific, limits = c(0, 12e5)) +
  theme(aspect.ratio=0.6, axis.text = element_blank(), axis.title = element_blank())
```

## Turning to data from a different source

The incompleteness of the data being unsatisfactory, there was the need to look for data from a different source. The online publication @ourworl is one such source of data. As an respective [Wikipedia article](https://en.wikipedia.org/wiki/Our_World_in_Data) states, Our World in Data (OWID) focuses on large global problems such as poverty, disease, hunger, climate change, war, existential risks, and inequality.

OWID is a charity, founded by Max Roser, a social historian and development economist. Its research team is based at the University of Oxford. OWID-data have been used in academic scientific journals and major newspapers of the world.

```{r reading_data_from_OWID, message=FALSE, echo=FALSE}
##############################################################
# to avoid multiple access to OWID during the project development, the data are read in only once, 
# and then stored in an object that is written to disk in an .rds-file.
# If that file exists, no attempt is made at re-reading the data from OWID source.
##############################################################
if (file.exists("./suicid_owid_big_list.rds")) {
    suicid_owid_big_list <- readRDS(file = "./suicid_owid_big_list.rds") 
    list_of_suicid_owid_tables <- readRDS(file = "./list_of_suicid_owid_tables.rds") 
    other_owid_big_list <- readRDS(file = "./other_owid_big_list.rds") 
    list_of_other_owid_tables <- readRDS(file = "./list_of_other_owid_tables.rds") 
} else {
    suicide_owid <- as_tibble(owid_search("suicide"))
    for(i in 1:nrow(suicide_owid)) {
        assign(tolower(gsub("\\-", "_", suicide_owid[i,]$chart_id)), 
           owid(suicide_owid[i,]$chart_id)
        )
    }
    suicid_owid_big_list <- lapply( tolower(gsub("\\-", "_", suicide_owid$chart_id)), get)
    names(suicid_owid_big_list) <- tolower(gsub("\\-", "_", suicide_owid$chart_id))
    saveRDS(suicid_owid_big_list, "./suicid_owid_big_list.rds")
    list_of_suicid_owid_tables <- suicide_owid %>% mutate(proj_chart_id = tolower(gsub("\\-", "_", chart_id))) # save the chart_id with minus sign replaced by underscore
    saveRDS(list_of_suicid_owid_tables, "./list_of_suicid_owid_tables.rds")
    ##############################################################
    # remove objects, that are now in suicid_owid_big_list to avoid cluttering of the environment
    ##############################################################
    rm(list=list_of_suicid_owid_tables$proj_chart_id)

    ##############################################################
    # grab other possibly relevant data from OWID
    ##############################################################
    other_OWID <- do.call("rbind", list(
    data.frame("titles"="Human Development Index vs. Corruption Perception Index",                    "chart_id"="human-development-index-vs-corruption-perception-index")             ,
    data.frame("titles"="Human Development Index vs. GDP per capita",                                 "chart_id"="human-development-index-vs-gdp-per-capita")                          ,
    data.frame("titles"="Gender Inequality Index from the Human Development Report",                  "chart_id"="gender-inequality-index-from-the-human-development-report")          ,
    data.frame("titles"="Human Development Index",                                                    "chart_id"="human-development-index")                                            ,
    data.frame("titles"="Life expectancy vs. expected years lived with disability or disease",        "chart_id"="life-expectancy-vs-expected-years-lived-with-disability")            ,
    data.frame("titles"="Life expectancy vs. GDP per capita",                                         "chart_id"="life-expectancy-vs-gdp-per-capita")                                  ,
    data.frame("titles"="Inequality in life expectancy vs. health expenditure per capita",            "chart_id"="inequality-in-life-expectancy-vs-health-expenditure-per-capita")     ,
    data.frame("titles"="Life expectancy vs. health expenditure",                                     "chart_id"="life-expectancy-vs-health-expenditure")                              ,
    data.frame("titles"="Life expectancy vs. health expenditure per capita",                          "chart_id"="life-expectancy-vs-health-expenditure-per-capita")                   ,
    data.frame("titles"="Life expectancy at birth, including the UN projections",                     "chart_id"="life-expectancy-at-birth-including-the-un-projections")              ,
    data.frame("titles"="Share in poverty vs. Life expectancy",                                       "chart_id"="poverty-vs-life-expectancy")                                         ,
    data.frame("titles"="Life expectancy",                                                            "chart_id"="life-expectancy")                                                    ,
    data.frame("titles"="Population by broad age group, World",                                       "chart_id"="population-by-broad-age-group")                                      ,
    data.frame("titles"="Life satisfaction vs. life expectancy",                                      "chart_id"="life-satisfaction-vs-life-expectancy")                               ,
    data.frame("titles"="Healthy life expectancy and years lived with disability",                    "chart_id"="healthy-life-expectancy-and-years-lived-with-disability")            ,
    data.frame("titles"="Prevalence of alcohol use disorders by age",                                 "chart_id"="prevalence-of-alcohol-use-disorders-by-age")                         ,
    data.frame("titles"="Prevalence of alcohol use disorders in males vs. females",                   "chart_id"="prevalence-of-alcohol-disorders-males-vs-females")                   ,
    data.frame("titles"="Child mortality vs. Prevalence of child wasting",                            "chart_id"="child-mortality-vs-wasting")                                         ,
    data.frame("titles"="Child mortality vs. Prevalence of stunting",                                 "chart_id"="child-mortality-vs-prevalence-of-stunting")                          ,
    data.frame("titles"="Prevalence of ADHD in males vs females",                                     "chart_id"="prevalence-adhd-in-males-vs-females")                                ,
    data.frame("titles"="Prevalence of anxiety disorders by age",                                     "chart_id"="prevalence-of-anxiety-disorders-by-age")                             ,
    data.frame("titles"="Prevalence of anxiety disorders, males vs. females",                         "chart_id"="prevalence-of-anxiety-disorders-males-vs-females")                   ,
    data.frame("titles"="Prevalence of bipolar disorder by age",                                      "chart_id"="prevalence-of-bipolar-disorder-by-age")                              ,
    data.frame("titles"="Prevalence of bipolar disorder in males vs. females",                        "chart_id"="prevalence-of-bipolar-disorder-in-males-vs-females")                 ,
    data.frame("titles"="Prevalence of depression by age",                                            "chart_id"="prevalence-of-depression-by-age")                                    ,
    data.frame("titles"="Prevalence of depression, males vs. females",                                "chart_id"="prevalence-of-depression-males-vs-females")                          ,
    data.frame("titles"="Prevalence of eating disorders by age",                                      "chart_id"="prevalence-of-eating-disorders-by-age")                              ,
    data.frame("titles"="Prevalence of schizophrenia by age",                                         "chart_id"="prevalence-of-schizophrenia-by-age")                                 ,
    data.frame("titles"="Prevalence of schizophrenia in males vs. females",                           "chart_id"="prevalence-of-schizophrenia-in-males-vs-females")                    ,
    data.frame("titles"="Average years of schooling vs. GDP per capita",                              "chart_id"="average-years-of-schooling-vs-gdp-per-capita")                       ,
    data.frame("titles"="How important is God in your life? vs GDP per capita, 2014",                 "chart_id"="how-important-is-god-in-your-life-vs-gdp-per-capita")                ,
    data.frame("titles"="Self-reported life satisfaction, 2003 to 2020",                              "chart_id"="happiness-cantril-ladder")                                           ,
    data.frame("titles"="Happiness vs. life satisfaction, 2015",                                      "chart_id"="happiness-wvs-vs-gallup")                                            ,
    data.frame("titles"="Civil liberties, 2021",                                                      "chart_id"="civil-liberties")                                                    ,
    data.frame("titles"="Share of people agreeing with the statement \"most people can be trusted\"", "chart_id"="self-reported-trust-attitudes")
    ))
    for(i in 1:nrow(other_OWID)) {
        assign(tolower(gsub("\\-", "_", other_OWID[i,]$chart_id)), 
           owid(other_OWID[i,]$chart_id)
        )
    }
    other_owid_big_list <- lapply( tolower(gsub("\\-", "_", other_OWID$chart_id)), get)
    names(other_owid_big_list) <- tolower(gsub("\\-", "_", other_OWID$chart_id))
    saveRDS(other_owid_big_list, "./other_owid_big_list.rds")
    list_of_other_owid_tables <- other_OWID %>% mutate(proj_chart_id = tolower(gsub("\\-", "_", chart_id))) # save the chart_id with minus sign replaced by underscore
    saveRDS(list_of_other_owid_tables, "./list_of_other_owid_tables.rds")
    ##############################################################
    # remove objects, that are now in other_owid_big_list to avoid cluttering of the environment
    ##############################################################
    rm(list=list_of_other_owid_tables$proj_chart_id)
}

##############################################################
# collect data on Human Development Index (which on the UNDPP-site are more complete compared to OWID)
##############################################################
if (file.exists("./UNDP_HDI.rds")) {
    UNDP_HDI <- readRDS(file = "./UNDP_HDI.rds")
} else {
    fname <- "https://hdr.undp.org/sites/default/files/2021-22_HDR/HDR21-22_Composite_indices_complete_time_series.csv"
    if(!file.exists("./HDR21-22_Composite_indices_complete_time_series.csv")){
         download.file(fname,"HDR21-22_Composite_indices_complete_time_series.csv",
                       method="curl",
                       mode="wb") # "wb" means "write binary"
    }
    UNDP_HDI <- read.csv("./HDR21-22_Composite_indices_complete_time_series.csv")
    UNDP_HDI <- UNDP_HDI[, c("iso3", "country","hdi_1997", "hdi_1998", "hdi_1999", "hdi_2000", "hdi_2001", "hdi_2002", "hdi_2003", "hdi_2004", "hdi_2005", "hdi_2006", "hdi_2007", "hdi_2008", "hdi_2009", "hdi_2010", "hdi_2011", "hdi_2012", "hdi_2013", "hdi_2014", "hdi_2015", "hdi_2016", "hdi_2017")]
    names(UNDP_HDI)[3:23] <- (names(UNDP_HDI)[3:23] %>%  str_sub(-4))
    UNDP_HDI <- UNDP_HDI %>%  gather(year, hdi, `1997`:`2017`) %>% mutate(year = as.numeric(year))
    UNDP_HDI <- UNDP_HDI[order(UNDP_HDI$iso3), ] 
    names(UNDP_HDI)[1] <- "code"
    saveRDS(UNDP_HDI, "./UNDP_HDI.rds")
}

##############################################################
# collect data on Gender Inequality Index from the UNDPP-site, for GII see: https://hdr.undp.org/content/measuring-key-disparities-human-development
##############################################################
if (file.exists("./UNDP_GII.rds")) {
    UNDP_GII <- readRDS(file = "./UNDP_GII.rds")
} else {
    fname <- "https://hdr.undp.org/sites/default/files/2021-22_HDR/HDR21-22_Composite_indices_complete_time_series.csv"
    if(!file.exists("./HDR21-22_Composite_indices_complete_time_series.csv")){
         download.file(fname,"HDR21-22_Composite_indices_complete_time_series.csv",
                       method="curl",
                       mode="wb") # "wb" means "write binary"
    }
    UNDP_GII <- read.csv("./HDR21-22_Composite_indices_complete_time_series.csv")
    UNDP_GII <- UNDP_GII[, c("iso3", "country","gii_1997", "gii_1998", "gii_1999", "gii_2000", "gii_2001", "gii_2002", "gii_2003", "gii_2004", "gii_2005", "gii_2006", "gii_2007", "gii_2008", "gii_2009", "gii_2010", "gii_2011", "gii_2012", "gii_2013", "gii_2014", "gii_2015", "gii_2016", "gii_2017")]
    names(UNDP_GII)[3:23] <- (names(UNDP_GII)[3:23] %>%  str_sub(-4))
    UNDP_GII <- UNDP_GII %>%  gather(year, gii, `1997`:`2017`) %>% mutate(year = as.numeric(year))
    UNDP_GII <- UNDP_GII[order(UNDP_GII$iso3), ] 
    names(UNDP_GII)[1] <- "code"
    saveRDS(UNDP_GII, "./UNDP_GII.rds")
}

##############################################################
# GDP-data from the Maddison Project Database 2020 are being used (with Geary–Khamis dollar based on 1990: https://en.wikipedia.org/wiki/International_dollar https://stats.oecd.org/glossary/detail.asp?ID=5528)
##############################################################
fname <- "https://www.rug.nl/ggdc/historicaldevelopment/maddison/data/mpd2020.xlsx"
if(!file.exists("./mpd2020.xlsx")){
     download.file(fname,"mpd2020.xlsx",
                   method="curl",
                   mode="wb") # "wb" means "write binary"
}
maddison_gdp_data <- read.xlsx(xlsxFile = "./mpd2020.xlsx", sheet = "Full data", startRow = 1, colNames = TRUE)
colnames(maddison_gdp_data)[1] <- "code"
colnames(maddison_gdp_data)[2] <- "entity"
colnames(maddison_gdp_data)[5] <- "population"

```

The recently published published owidR-package [@york2022] provides a handy R-interface to the OWID-data. Using the functions of the owidR-package it is possible to retrieve a number of data sets on the topics listed in table \@ref(tab:OWIDTopics).

```{r OWIDTopics, echo=FALSE}
kbl(list_of_suicid_owid_tables$titles, booktabs = T, caption = "topics covered in the OWID tables on suicide", col.names=("Topics")) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = c("striped", "condensed"), font_size = 8, full_width = F, position = "left")
```

In addition to the *suicide*-related data other from OWID were used as well. These Topics of these data (mainly epidemiological and societal measures) are presented in table \@ref(tab:otherOWIDTopics) in the Appendix.

All OWID-data have three fields in common: *"entity"*, *"code"*, and *"year"*, with *"entity"* designating the country or region from which the data were collected, *"code"* designating a country-code (where applicable), and *"year"* designating the year in which the respective data were collected. Among the *"entities"* there are a number of items that are already aggregated according to criteria e.g. of [WHO](https://www.who.int/about/who-we-are/regional-offices) or [WorldBank](https://datatopics.worldbank.org/world-development-indicators/images/figures-png/world-by-region-map.pdf). When doing analyses based on countries, these records have to be excluded from the OWID-tables.

```{r Calculation_for_WorldMapOWIDTotalSuicideNumbers, message=FALSE, echo=FALSE}
##############################################################
# for each country the total suicide numbers are summed up for the whole time period that is represented in the OWID-data
##############################################################
OWID_gross_suicides_country <- suicid_owid_big_list["suicide_deaths_by_age"] %>% first()
names(OWID_gross_suicides_country)[names(OWID_gross_suicides_country) == "Deaths - Self-harm - Sex: Both - Age: 70+ years (Number)"] <- "age70"
names(OWID_gross_suicides_country)[names(OWID_gross_suicides_country) == "Deaths - Self-harm - Sex: Both - Age: 50-69 years (Number)"] <- "age50"
names(OWID_gross_suicides_country)[names(OWID_gross_suicides_country) == "Deaths - Self-harm - Sex: Both - Age: 15-49 years (Number)"] <- "age15"
names(OWID_gross_suicides_country)[names(OWID_gross_suicides_country) == "Deaths - Self-harm - Sex: Both - Age: 5-14 years (Number)"] <- "age5"
OWID_gross_suicides_country <- OWID_gross_suicides_country %>% mutate(yearly_sum = age70+age50+age15+age5)
OWID_gross_suicides_country <- OWID_gross_suicides_country %>% group_by(entity) %>% summarise(entity_suicides=sum(yearly_sum))
##############################################################
# the aggregated entities (like "world", "G20" etc. are being removed from the data
##############################################################
OWID_gross_suicides_country <- OWID_gross_suicides_country %>% filter(entity != "World") %>% filter(entity != "G20") %>% filter(entity != "OECD Countries") %>% filter(!grepl("World Bank ", entity)) %>% filter(!grepl("(WB)", entity)) %>% filter(!grepl("(WHO)", entity))
##############################################################
# the partial entities of the UK (like "Wales" etc. are being removed from the data
##############################################################
OWID_gross_suicides_country <- OWID_gross_suicides_country %>% filter(!(entity %in% c("Wales", "Scotland", "England", "Northern Ireland")))

##############################################################
# the map's data are read from a variable given in ggplot2
##############################################################
world <- map_data("world")

##############################################################
# because of different designations of countries' names in the "world" and the "OWID_gross_suicides_country" data, names have to be reworked a little
# code to identify non-matching country-names:
# wrong_country_names <- left_join(OWID_gross_suicides_country, world, by=c("entity" = "region")) %>% filter(is.na(long))%>%pull(entity)
##############################################################
world[which(world$region == "Saint Kitts" | world$region == "Nevis"),]$region        <- "Saint Kitts and Nevis"
world[which(world$region == "Saint Vincent" | world$region == "Grenadines"),]$region <- "Saint Vincent and the Grenadines"
world[which(world$region == "Trinidad" | world$region == "Tobago"),]$region          <- "Trinidad and Tobago"
world[which(world$region == "UK"),]$region                                           <- "United Kingdom"
world[which(world$region == "USA"),]$region                                          <- "United States"
world[which(world$region == "Antigua" | world$region == "Barbuda"),]$region          <- "Antigua and Barbuda"
world[which(world$region == "Democratic Republic of the Congo"),]$region             <- "Democratic Republic of Congo"
world[which(world$region == "Republic of Congo"),]$region                            <- "Congo"
world[which(world$region == "Ivory Coast"),]$region                                  <- "Cote d'Ivoire"
world[which(world$region == "Timor-Leste"),]$region                                  <- "Timor"
world[which(world$region == "Czech Republic"),]$region                               <- "Czechia"
world[which(world$region == "Virgin Islands"),]$region                               <- "United States Virgin Islands"
world[which(world$region == "Micronesia"),]$region                                   <- "Micronesia (country)"

countries_without_suicide_data <- world %>% merge(OWID_gross_suicides_country, by.x = "region", by.y = "entity", all.x = T) %>% filter(is.na(entity_suicides)) %>% pull(region) %>% as_tibble() %>% unique() %>% pull(value) %>% str_flatten(collapse = ", ")
```

Overall the *OWID*-data seem to cover more regions of the world than the *Kaggle*-data, as shown in figure \@ref(fig:WorldMapOWIDTotalSuicideNumbers). However a small number of countries that are in the OWID-data, but not in the world-map provided with ggplot (*`r anti_join((OWID_gross_suicides_country %>% mutate(region = entity) %>% pull(region) %>% unique() %>% as_tibble()), (world %>% pull(region) %>% unique() %>% as_tibble())) %>% pull(value) %>% str_flatten(collapse = ", ")`*) had to be excluded from the plot[^1].

[^1]: It might be noteworthy, that for a number of countries no suicide-data are given in the OWID-data set. These are: *`r countries_without_suicide_data`*.

```{r WorldMapOWIDTotalSuicideNumbers, message=FALSE, echo=FALSE, fig.cap="map of OWID data on total suicide numbers worldwide", out.width = "70%"}
##############################################################
# plot the world map data
##############################################################
world %>%
  merge(OWID_gross_suicides_country, by.x = "region", by.y = "entity", all.x = T) %>%
  arrange(group, order) %>%
  ggplot(aes(x = long, y = lat, group = group, fill = entity_suicides)) +
  geom_polygon(color = "gray90", size = 0.1) +
  scale_fill_viridis(name="total no. of\nsuicides\nover entire\ntime-span\ncovered", option="H", begin=0.6, end=0.9, na.value = "white", labels = fancy_scientific, limits = c(0, 56e5)) +
  theme(aspect.ratio=0.6, axis.text = element_blank(), axis.title = element_blank())
```

```{r Get_OWID_Sources_Info, message=FALSE, echo=FALSE, warnings=FALSE}
##############################################################
# to avoid multiple access to OWID during the project development, the data are read in only once, 
# and then stored in an object that is written to disk in an .rds-file.
# If that file exists, no attempt is made at re-reading the data from OWID source.
##############################################################
library(RSelenium)
if (file.exists("./owid_sources.rds")) {
    owid_sources <- readRDS(file = "./owid_sources.rds") 
    detach("package:RSelenium", unload = TRUE) ## to free up memory space
} else {
    ##############################################################
    # Google Chrome browser and Chromium Driver is needed (pay attention to the correct version): https://chromedriver.chromium.org/downloads
    ##############################################################
    driver <- RSelenium::rsDriver(browser = "chrome",
                                  port=4884L, 
                                  chromever =
                                  system2(command = "wmic",
                                          args = 'datafile where name="C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe" get Version /value',
                                          stdout = TRUE,
                                          stderr = TRUE) %>%
                                  stringr::str_extract(pattern = "(?<=Version=)\\d+\\.\\d+\\.\\d+\\.") %>%
                                  magrittr::extract(!is.na(.)) %>%
                                  stringr::str_replace_all(pattern = "\\.",
                                                           replacement = "\\\\.") %>%
                                  paste0("^",  .) %>%
                                  stringr::str_subset(string =
                                                         binman::list_versions(appname = "chromedriver") %>%
                                                         dplyr::last()) %>%
                                  as.numeric_version() %>%
                                  max() %>%
                                  as.character())
    remote_driver <- driver[["client"]]
    owid_sources <- data.frame() 
    for (i in 1:nrow(list_of_suicid_owid_tables)) {
         ##############################################################
         # determine URL ffrom list of OWID suicide-related tables
         ##############################################################
         url <- paste0("https://ourworldindata.org/grapher/", list_of_suicid_owid_tables$chart_id[i], "?tab=table")

         ##############################################################
         # connect to the URL
         ##############################################################
         remote_driver$navigate(url)
         ##############################################################
         # from the tables tab, determine where the "SOURCES"-tab is (sometimes 3rd, sometimes 4th etc)
         ##############################################################
         footer_tabs <- remote_driver$findElement("class name", "ControlsFooter")$getElementText()
         currentTab <- footer_tabs %>%  str_split(pattern="\\n") %>% rbind.data.frame()
         colnames(currentTab) <- ("x")
         currentTab <- currentTab[ which(is.na(as.numeric(currentTab$x))), ] %>% as_tibble() 
         colnames(currentTab) <- ("x")
         currentTab <- which(currentTab$x=="SOURCES") 
         ##############################################################
         # click the "SOURCES"-tab 
         ##############################################################
         remote_driver$findElement("xpath", paste0("/html/body/main/figure/div/div[2]/div/nav/ul/li[",currentTab,"]/a"))$clickElement()
         ##############################################################
         # read the contents
         ##############################################################
          owid_sources <- rbind(owid_sources, c(list_of_suicid_owid_tables$titles[i], list_of_suicid_owid_tables$chart_id[i], list_of_suicid_owid_tables$proj_chart_id[i], remote_driver$findElement("xpath", "/html/body/main/figure/div/div[3]/div/div")$getElementAttribute('innerHTML') ) )
    }
    colnames(owid_sources)<-c("title", "chart_id", "proj_chart_id", "sources_content")
    saveRDS(owid_sources, "./owid_sources.rds")
}
library(RSelenium)
if (file.exists("./other_owid_sources.rds")) {
    other_owid_sources <- readRDS(file = "./other_owid_sources.rds") 
    detach("package:RSelenium", unload = TRUE) ## to free up memory space
} else {
    ##############################################################
    # Google Chrome browser and Chromium Driver is needed (pay attention to the correct version): https://chromedriver.chromium.org/downloads
    ##############################################################
    driver <- RSelenium::rsDriver(browser = "chrome",
                                  port=4897L, 
                                  chromever =
                                  system2(command = "wmic",
                                          args = 'datafile where name="C:\\\\Program Files\\\\Google\\\\Chrome\\\\Application\\\\chrome.exe" get Version /value',
                                          stdout = TRUE,
                                          stderr = TRUE) %>%
                                  stringr::str_extract(pattern = "(?<=Version=)\\d+\\.\\d+\\.\\d+\\.") %>%
                                  magrittr::extract(!is.na(.)) %>%
                                  stringr::str_replace_all(pattern = "\\.",
                                                           replacement = "\\\\.") %>%
                                  paste0("^",  .) %>%
                                  stringr::str_subset(string =
                                                         binman::list_versions(appname = "chromedriver") %>%
                                                         dplyr::last()) %>%
                                  as.numeric_version() %>%
                                  max() %>%
                                  as.character())
    remote_driver <- driver[["client"]]
    other_owid_sources <- data.frame() 
    for (i in 1:nrow(list_of_other_owid_tables)) {
         ##############################################################
         # determine URL ffrom list of other OWID  tables
         ##############################################################
         url <- paste0("https://ourworldindata.org/grapher/", list_of_other_owid_tables$chart_id[i], "?tab=table")

         ##############################################################
         # connect to the URL
         ##############################################################
         remote_driver$navigate(url)
         ##############################################################
         # from the tables tab, determine where the "SOURCES"-tab is (sometimes 3rd, sometimes 4th etc)
         ##############################################################
         footer_tabs <- remote_driver$findElement("class name", "ControlsFooter")$getElementText()
         currentTab <- footer_tabs %>%  str_split(pattern="\\n") %>% rbind.data.frame()
         colnames(currentTab) <- ("x")
         currentTab <- currentTab[ which(is.na(as.numeric(currentTab$x))), ] %>% as_tibble() 
         colnames(currentTab) <- ("x")
         currentTab <- which(currentTab$x=="SOURCES") 
         ##############################################################
         # click the "SOURCES"-tab 
         ##############################################################
         remote_driver$findElement("xpath", paste0("/html/body/main/figure/div/div[2]/div/nav/ul/li[",currentTab,"]/a"))$clickElement()
         ##############################################################
         # read the contents
         ##############################################################
          other_owid_sources <- rbind(other_owid_sources, c(list_of_other_owid_tables$titles[i], list_of_other_owid_tables$chart_id[i], list_of_other_owid_tables$proj_chart_id[i], remote_driver$findElement("xpath", "/html/body/main/figure/div/div[3]/div/div")$getElementAttribute('innerHTML') ) )
    }
    colnames(other_owid_sources)<-c("title", "chart_id", "proj_chart_id", "sources_content")
    saveRDS(other_owid_sources, "./other_owid_sources.rds")
}
```

## Sources and date range of the OWID-data

The **OWID**-website adds to each chart or table it provides information on the **source of the data**. This information is accessible using a **"SOURCES"**-tab on each of the respective pages where OWID presents its data[^2]. The tabulated info on the *sources* of the OWID-data extracted from the OWID-website are to be found in the Appendix (see Ch. \@ref(the-appendix) of this paper).

[^2]: As the OWID-website relies heavily on the use of Javascript driven technologies that dynamically change the structure of the web pages, it was not possible to just use e.g. `rvest` to scrape this information from the OWID-website. Instead it was necessary to use a *browser* (in the present case *chrome*) remotely administered from $R$ using the *Selenium WebDriver* and the `RSelenium`-package. The data were then imported into $R$ using the functions `minimal_html()`, `html_elements()`, and `html_text()` from the `rvest`-package.

From this it can be seen that the time scale of the data in particular is very different. E.g. data for *Male-to-female ratio of suicide rates* range from **1990** to **2017**, while data on *historical estimation of population* (relevant within the context of suicide rates vs. prevalence of depression) range from **10,000 BCE** to **2021**. Data for *share of suicide deaths from pesticide poisoning* are available for only **one** year (*2014*).

```{r Building_Analysis_Data_Set, message=FALSE, echo=FALSE, collapse=TRUE}
##############################################################
# Data from the UN Population Division are being used
##############################################################
fname <- "https://population.un.org/wpp/Download/Files/1_Indicators%20(Standard)/EXCEL_FILES/1_General/WPP2022_GEN_F01_DEMOGRAPHIC_INDICATORS_COMPACT_REV1.xlsx"
if(!file.exists("./WPP2022_GEN_F01_DEMOGRAPHIC_INDICATORS_COMPACT_REV1.xlsx")){
     download.file(fname,"WPP2022_GEN_F01_DEMOGRAPHIC_INDICATORS_COMPACT_REV1.xlsx",
                   method="curl", #use "curl" for OS X / Linux, "wininet" for Windows
                   mode="wb") # "wb" means "write binary"
}
UN_pop_data <- read.xlsx(xlsxFile = "./WPP2022_GEN_F01_DEMOGRAPHIC_INDICATORS_COMPACT_REV1.xlsx", sheet = "Estimates", startRow = 17, colNames = TRUE)
colnames(UN_pop_data)[6] <- "code"
colnames(UN_pop_data)[11] <- "year"
colnames(UN_pop_data)[13] <- "population"
colnames(UN_pop_data)[14] <- "m_population"
colnames(UN_pop_data)[15] <- "f_population"
colnames(UN_pop_data)[18] <- "median_age"

##############################################################
# for each country the total suicide numbers are summed up, this time only for the time period 1990 - 2017
##############################################################
OWID_gross_suicides_country <- suicid_owid_big_list["suicide_deaths_by_age"] %>% first()
OWID_gross_suicides_country <- OWID_gross_suicides_country[which(OWID_gross_suicides_country$year >= 1990 &OWID_gross_suicides_country$year <= 2017) ,]
OWID_gross_suicides_country[which(OWID_gross_suicides_country$entity %in% c("Wales", "Scotland", "England", "Northern Ireland")) ,]$code <- "GBR" # set country code for United Kingdom
OWID_gross_suicides_country[which(OWID_gross_suicides_country$entity %in% c("Wales", "Scotland", "England", "Northern Ireland")) ,]$entity <- "United Kingdom"
names(OWID_gross_suicides_country)[names(OWID_gross_suicides_country) == "Deaths - Self-harm - Sex: Both - Age: 70+ years (Number)"] <- "age70plus"
names(OWID_gross_suicides_country)[names(OWID_gross_suicides_country) == "Deaths - Self-harm - Sex: Both - Age: 50-69 years (Number)"] <- "age50_69"
names(OWID_gross_suicides_country)[names(OWID_gross_suicides_country) == "Deaths - Self-harm - Sex: Both - Age: 15-49 years (Number)"] <- "age15_49"
names(OWID_gross_suicides_country)[names(OWID_gross_suicides_country) == "Deaths - Self-harm - Sex: Both - Age: 5-14 years (Number)"] <- "age5_14"
OWID_gross_suicides_country <- OWID_gross_suicides_country %>% mutate(yearly_sum = age70plus+age50_69+age15_49+age5_14)
OWID_gross_suicides_country <- rbind(OWID_gross_suicides_country %>% filter(code != "GBR"), OWID_gross_suicides_country %>% filter(code == "GBR") %>% group_by(year) %>% filter(yearly_sum == max(yearly_sum)) ) # the separate data for "Wales", "Scotland", "England", and "Northern Ireland" have to be deleted, as this information is now integrated in "United Kingdom"
OWID_gross_suicides <- OWID_gross_suicides_country

##############################################################
# the aggregated entities (like "world", "G20" etc. are being removed from the data
##############################################################
OWID_gross_suicides_country <- OWID_gross_suicides_country %>% filter(entity != "World") %>% filter(entity != "G20") %>% filter(entity != "OECD Countries") %>% filter(!grepl("World Bank ", entity)) %>% filter(!grepl("(WB)", entity)) %>% filter(!grepl("(WHO)", entity))

##############################################################
# calculation of suicide rates based on UN population data
##############################################################
OWID_gross_suicides_rates <- merge(x = OWID_gross_suicides_country, y = UN_pop_data[, c("code", "year", "population")], by=c("code", "year"), all.x=TRUE) %>% mutate(population=round(as.numeric(population)*1000)) %>% group_by(entity) %>% summarise(mean_suicides=mean(yearly_sum), mean_population=mean(population)) %>% mutate(avg_suicide_rate=(mean_suicides/(mean_population/100000)))

##############################################################
# a more full table is calculated for the purpose of further analyses
##############################################################

##############################################################
# read in median_age, total, male & female population (1st of July each year) from UN population division data
##############################################################
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = UN_pop_data[, c("code", "year", "population", "m_population", "f_population", "median_age")], by=c("code", "year"), all.x=TRUE) %>% mutate(median_age=as.numeric(median_age), population=round(as.numeric(population)*1000), m_population=round(as.numeric(m_population)*1000), f_population=round(as.numeric(f_population)*1000)) %>% filter(!(entity %in% c("World", "G20", "OECD Countries"))) %>% filter(!grepl("World Bank ", entity)) %>% filter(!grepl("(WB)", entity)) %>% filter(!grepl("(WHO)", entity))

##############################################################
# death from self-harm (OWID, poulation age-standardized)
##############################################################
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = ( first(suicid_owid_big_list["suicide_death_rates_by_sex"]) %>% select(-"code") ), by=c("entity", "year"), all.x=TRUE)
names(OWID_gross_suicides)[names(OWID_gross_suicides) == "Male suicide rate"] <- "m_suic_rate"
names(OWID_gross_suicides)[names(OWID_gross_suicides) == "Female suicide rate"] <- "f_suic_rate"
names(OWID_gross_suicides)[names(OWID_gross_suicides) == "Deaths - Self-harm - Sex: Both - Age: Age-standardized (Rate)"] <- "mf_slfhrmdeath_age_stand"

##############################################################
# death from interpersonal violence (OWID, poulation age-standardized)
##############################################################
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = ( first(suicid_owid_big_list["suicide_vs_homicide_rate"]) %>% select(-"code")  %>% select(-"Population") %>% select(-"Countries Continents") %>% select(-"Deaths - Self-harm - Sex: Both - Age: Age-standardized (Rate)") ), by=c("entity", "year"), all.x=TRUE) %>% mutate(suic_rate=(yearly_sum/(population/100000)))
names(OWID_gross_suicides)[names(OWID_gross_suicides) == "Deaths - Interpersonal violence - Sex: Both - Age: Age-standardized (Rate)"] <- "mf_ipvioldeath_age_stand"

##############################################################
# population by broad age groups
##############################################################
tmp <- first(other_owid_big_list["population_by_broad_age_group"]) %>% select(-"code") 
names(tmp)[names(tmp) == "Population by broad age group - Sex: all - Age: 65+ - Variant: estimates"] <- "popage65plus"
names(tmp)[names(tmp) == "Population by broad age group - Sex: all - Age: 25-64 - Variant: estimates"] <- "popage25to64"
names(tmp)[names(tmp) == "Population by broad age group - Sex: all - Age: 15-24 - Variant: estimates"] <- "popage15to24"
names(tmp)[names(tmp) == "Population by broad age group - Sex: all - Age: 5-14 - Variant: estimates"] <- "popage5to14"
names(tmp)[names(tmp) == "Population by broad age group - Sex: all - Age: 0-4 - Variant: estimates"] <- "popage0to4"
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = tmp, by=c("entity", "year"), all.x=TRUE)
rm(tmp)

##############################################################
# prevalence of mental and substance abuse disorders (OWID, poulation age-standardized)
##############################################################
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = ( first(suicid_owid_big_list["suicide_rates_vs_prevalence_of_mental_and_substance_use_disorders"]) %>% select(-"code") %>% select(-"Deaths - Self-harm - Sex: Both - Age: Age-standardized (Rate)") %>% select(-"Population") %>% select(-"Countries Continents") ), by=c("entity", "year"), all.x=TRUE)
names(OWID_gross_suicides)[names(OWID_gross_suicides) == "Prevalence - Mental and substance use disorders - Sex: Both - Age: Age-standardized (Rate)"] <- "mf_prev_md_s_ab_age_stand"

##############################################################
# prevalence of ADHD (OWID, poulation age-standardized)
##############################################################
tmp <- first(other_owid_big_list["prevalence_adhd_in_males_vs_females"]) %>% select(-"code") %>% select(-"Population") %>% select(-"Countries Continents") 
names(tmp)[names(tmp) == "Prevalence - Attention-deficit/hyperactivity disorder - Sex: Male - Age: Age-standardized (Percent)"] <- "m_prev_adhd"
names(tmp)[names(tmp) == "Prevalence - Attention-deficit/hyperactivity disorder - Sex: Female - Age: Age-standardized (Percent)"] <- "f_prev_adhd"
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = tmp, by=c("entity", "year"), all.x=TRUE)
rm(tmp)

##############################################################
# prevalence of alcohol disorders (OWID, poulation age-standardized)
##############################################################
tmp <- first(other_owid_big_list["prevalence_of_alcohol_disorders_males_vs_females"]) %>% select(-"code") %>% select(-"Population") %>% select(-"Countries Continents") 
names(tmp)[names(tmp) == "Prevalence - Alcohol use disorders - Sex: Male - Age: Age-standardized (Percent)"] <- "m_prev_alco"
names(tmp)[names(tmp) == "Prevalence - Alcohol use disorders - Sex: Female - Age: Age-standardized (Percent)"] <- "f_prev_alco"
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = tmp, by=c("entity", "year"), all.x=TRUE)
rm(tmp)

##############################################################
# prevalence of depressive disorders (OWID, poulation age-standardized)
##############################################################
tmp <- first(other_owid_big_list["prevalence_of_depression_males_vs_females"]) %>% select(-"code") %>% select(-"Population") %>% select(-"Countries Continents") 
names(tmp)[names(tmp) == "Prevalence - Depressive disorders - Sex: Male - Age: Age-standardized (Percent)"] <- "m_prev_depr"
names(tmp)[names(tmp) == "Prevalence - Depressive disorders - Sex: Female - Age: Age-standardized (Percent)"] <- "f_prev_depr"
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = tmp, by=c("entity", "year"), all.x=TRUE)
rm(tmp)

##############################################################
# prevalence of anxiety disorders (OWID, poulation age-standardized)
##############################################################
tmp <- first(other_owid_big_list["prevalence_of_anxiety_disorders_males_vs_females"]) %>% select(-"code") %>% select(-"Population") %>% select(-"Countries Continents") 
names(tmp)[names(tmp) == "Prevalence - Anxiety disorders - Sex: Male - Age: Age-standardized (Percent)"] <- "m_prev_anxiety"
names(tmp)[names(tmp) == "Prevalence - Anxiety disorders - Sex: Female - Age: Age-standardized (Percent)"] <- "f_prev_anxiety"
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = tmp, by=c("entity", "year"), all.x=TRUE)
rm(tmp)

##############################################################
# prevalence of bipolar disorders (OWID, poulation age-standardized)
##############################################################
tmp <- first(other_owid_big_list["prevalence_of_bipolar_disorder_in_males_vs_females"]) %>% select(-"code") %>% select(-"Population") %>% select(-"Countries Continents") 
names(tmp)[names(tmp) == "Prevalence - Bipolar disorder - Sex: Male - Age: Age-standardized (Percent)"] <- "m_prev_bipolar"
names(tmp)[names(tmp) == "Prevalence - Bipolar disorder - Sex: Female - Age: Age-standardized (Percent)"] <- "f_prev_bipolar"
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = tmp, by=c("entity", "year"), all.x=TRUE)
rm(tmp)

##############################################################
# prevalence of schizophrenia (OWID, poulation age-standardized)
##############################################################
tmp <- first(other_owid_big_list["prevalence_of_schizophrenia_in_males_vs_females"]) %>% select(-"code") %>% select(-"Population") %>% select(-"Countries Continents") 
names(tmp)[names(tmp) == "Prevalence - Schizophrenia - Sex: Male - Age: Age-standardized (Percent)"] <- "m_prev_schizoph"
names(tmp)[names(tmp) == "Prevalence - Schizophrenia - Sex: Female - Age: Age-standardized (Percent)"] <- "f_prev_schizoph"
OWID_gross_suicides <- merge(x = OWID_gross_suicides, y = tmp, by=c("entity", "year"), all.x=TRUE)
rm(tmp)

##############################################################
# join left the HDI-data from UNDP_HDI
##############################################################
OWID_gross_suicides <- left_join(OWID_gross_suicides, (UNDP_HDI %>% select (-country)), by=c("code", "year"))

##############################################################
# join left the GII-data from UNDP_GII
##############################################################
OWID_gross_suicides <- left_join(OWID_gross_suicides, (UNDP_GII %>% select (-country)), by=c("code", "year"))

##############################################################
# join left the GDP-data from Madddison Project, see: https://www.rug.nl/ggdc/historicaldevelopment/maddison/releases/maddison-project-database-2020
##############################################################
# population differs between Maddison and UN data
OWID_gross_suicides <- left_join(OWID_gross_suicides, (maddison_gdp_data %>% select (-population) %>% select (-entity)), by=c("code", "year"))
OWID_gross_suicides <- OWID_gross_suicides %>% mutate(dollars_per_day = gdppc/365)

##############################################################
# Add data on People Living in Poverty from OWID github
##############################################################
fname <- "https://nyc3.digitaloceanspaces.com/owid-public/data/poverty/pip_dataset.csv"
if(!file.exists("./pip_dataset.csv")){
     download.file(fname,"./pip_dataset.csv",
                   method="curl",
                   mode="wb")
}
pip_data <- read.csv(file = "./pip_dataset.csv", header = TRUE, sep = ",")
pip_data <- pip_data %>% filter(year >= 1990 & year <= 2017 & ppp_version == 2017 & reporting_level == "national") %>% filter(!is.na(gini)) %>% mutate(ID = row_number())
pip_data <- pip_data[which(!rownames(pip_data) %in% (pip_data[, 1:2][duplicated(pip_data[, 1:2]),] %>% rownames())), ]
pip_data <- pip_data[, c("country", "year", "headcount_ratio_100", "headcount_ratio_1000", "gini")]
colnames(pip_data)[1] <- "entity"
colnames(pip_data)[3] <- "less_1_ratio"
colnames(pip_data)[4] <- "less_10_ratio"
OWID_gross_suicides <- left_join(OWID_gross_suicides, pip_data, by=c("entity", "year"))

##############################################################
# join left the self reprted trust variable
##############################################################
tmp <- first(other_owid_big_list["self_reported_trust_attitudes"])
colnames(tmp)[4] <- "self_rep_trust"
tmp <- tmp %>%  group_by (code) %>% summarize(entity = first(entity),self_rep_trust= mean(self_rep_trust) )
OWID_gross_suicides <- left_join(OWID_gross_suicides, (tmp %>% select (-entity)), by="code")
rm(tmp)

##############################################################
# Add data on Religious Commitment from PEW Research
##############################################################
fname <- "https://www.pewresearch.org/religion/wp-content/uploads/sites/7/2018/06/ReligiousCommitment-FULL-WEB.pdf"
if(!file.exists("./ReligiousCommitment-FULL-WEB.pdf")){
     download.file(fname,"./ReligiousCommitment-FULL-WEB.pdf",
                   method="curl",
                   mode="wb") # "wb" means "write binary"
}
txt <- pdf_text("./ReligiousCommitment-FULL-WEB.pdf")
raw_data_religious_commitment <- txt[65:68]

tab <- str_split(raw_data_religious_commitment, "\n")
tab <- rbind(
    tab[[1]][13:49] %>% str_trim %>% str_split("\\s{2,}", simplify = TRUE) %>% data.frame(stringsAsFactors = FALSE),
    tab[[2]][ 9:43] %>% str_trim %>% str_split("\\s{2,}", simplify = TRUE) %>% data.frame(stringsAsFactors = FALSE),
    tab[[3]][10:44] %>% str_trim %>% str_split("\\s{2,}", simplify = TRUE) %>% data.frame(stringsAsFactors = FALSE),
    tab[[4]][10:20] %>% str_trim %>% str_split("\\s{2,}", simplify = TRUE) %>% data.frame(stringsAsFactors = FALSE)
)

##############################################################
# some manual reworking is necessary as missing value are represented by blanks in the pdf, 
# also in the first lines of the tables there are percent signs, 
# and some lines of the pdf are distributed over multiple lines in the scanned data
##############################################################
## World
tab[1, 2:13] <- tab[1, 2:13] %>% str_sub(1, 2)
## Latin America-Caribbean
tab[4,1] <- paste0(tab[4,1], tab[6,1])
tab[4,2:13] <- tab[5,1:12]
tab <- tab[-6, ]
tab <- tab[-5, ]
## Middle East-North Africa
tab[5,1] <- paste0(tab[5,1], tab[7,1])
tab[5,2:13] <- tab[6,1:12]
tab <- tab[-7, ]
tab <- tab[-6, ]
## Sub-Saharan Africa
tab[6,1] <- paste0(tab[6,1], " ", tab[8,1])
tab[6,2:13] <- tab[7,1:12]
tab <- tab[-8, ]
tab <- tab[-7, ]

## Burkina Faso
tab[23,13] <- tab[23, 7]
tab[23, 7]  <- ""
tab[23,10] <- tab[23, 6]
tab[23, 6]  <- ""
tab[23, 9] <- tab[23, 5]
tab[23, 5]  <- ""
tab[23, 6] <- tab[23, 4]
tab[23, 4]  <- ""
tab[23, 5] <- tab[23, 3]
tab[23, 3]  <- ""

## Czech Republic
tab[32, 2:13] <- tab[32, 2:13] %>% str_sub(1, 2)

## India
tab[52, 12:13] <- tab[52, 9:10]
tab[52, 8:10] <- tab[52, 6:8]
tab[52, 7] <- ""
tab[52, 4:6] <- tab[52, 3:5]
tab[52, 3] <- ""

## Japan
tab[59, 12:13] <- tab[59, 9:10]
tab[59, 8:10] <- tab[59, 6:8]
tab[59, 7] <- ""
tab[59, 4:6] <- tab[59, 3:5]
tab[59, 3] <- ""

## Liberia
tab[67, 8:13] <- tab[67, 7:12]
tab[67, 7:8] <- c("85%", "83%")
tab[67, 2:13] <- str_replace(tab[67, 2:13], "%", "")

## Tunisia
tab[102, 2:13] <- str_replace(tab[102, 2:13], "%", "")

## Vietnam
tab[111, 12:13] <- tab[111, 9:10]
tab[111, 8:10] <- tab[111, 6:8]
tab[111, 7] <- ""
tab[111, 4:6] <- tab[111, 3:5]
tab[111, 3] <- ""

colnames(tab) <- c("entity", "all_affiliate", "all_weekly", "all_pray_d", "all_veryimp", "u40_affiliate", "u40_weekly", "u40_pray_d", "u40_veryimp", "40p_affiliate", "40p_weekly", "40p_pray_d", "40p_veryimp")
rel_commitment <- tab
rel_commitment <- rel_commitment %>% mutate_at(-1, parse_number) %>% as_tibble()
rm (tab)
### renaming entities based on the results of: anti_join(rel_commitment, OWID_gross_suicides, by="entity")
rel_commitment[which(rel_commitment$entity =="Bosnia-Herz."), ]$entity <- "Bosnia and Herzegovina"
rel_commitment[which(rel_commitment$entity =="Czech Republic"), ]$entity <- "Czechia"
rel_commitment[which(rel_commitment$entity =="Congo DR"), ]$entity <- "Democratic Republic of Congo"
rel_commitment[which(rel_commitment$entity =="Dominican Rep."), ]$entity <- "Dominican Republic"
rel_commitment[which(rel_commitment$entity =="Palestinian Terr."), ]$entity <- "Palestine"

OWID_gross_suicides <- left_join(OWID_gross_suicides, (rel_commitment %>% select(c("entity", "all_veryimp"))), by="entity")

##############################################################
# Add data on "Happiness" based on World Happiness Report: https://worldhappiness.report/ed/2022/
# https://happiness-report.s3.amazonaws.com/2022/DataForTable2.1.xls => for some reason there is a difference between WHR22 - data and OWID-data: apparently OWID data use wrong years
##############################################################
fname <- "https://happiness-report.s3.amazonaws.com/2022/DataForTable2.1.xls"
if(!file.exists("./DataForTable2.1.xls")){
     download.file(fname,"./DataForTable2.1.xls",
                   method="curl",
                   mode="wb") # "wb" means "write binary"
}
whr22_data <- read_excel("./DataForTable2.1.xls")
colnames(whr22_data)[1] <- "entity"
colnames(whr22_data)[3] <- "life_ladder"
colnames(whr22_data)[10] <- "positive_affect"
colnames(whr22_data)[11] <- "negative_affect"
whr22_data <- whr22_data[, c(1,2,3,10,11)]
### renaming entities based on the results of: anti_join(whr22_data, OWID_gross_suicides, by="entity")
whr22_data[which(whr22_data$entity =="Congo (Brazzaville)"), ]$entity <- "Congo"
whr22_data[which(whr22_data$entity =="Congo (Kinshasa)"), ]$entity <- "Democratic Republic of Congo"
whr22_data[which(whr22_data$entity =="Ivory Coast"), ]$entity <- "Cote d'Ivoire"
whr22_data[which(whr22_data$entity =="Palestinian Territories"), ]$entity <- "Palestine"
whr22_data[which(whr22_data$entity =="Taiwan Province of China"), ]$entity <- "Taiwan"

##############################################################
# join left the WorldHappiness Report 2022-data from https://worldhappiness.report/ed/2022/
##############################################################
OWID_gross_suicides <- left_join(OWID_gross_suicides, whr22_data, by=c("entity", "year"))

OWID_gross_suicides_no_imputation <- OWID_gross_suicides

##############################################################
# in the following: IMPUTATION of MISSING VALUES by linear regression
# IMPUTATION is mostly likely somewhat error-prone as linearity of trends is not guaranteed
##############################################################


##############################################################
# identify entities where hdi is missing & put those in a temporary df, excluding multi-national entities
##############################################################
tmp <- OWID_gross_suicides[which(is.na(OWID_gross_suicides$hdi)),  ] %>% select(c(entity, hdi)) %>% unique()
tmp <- tmp %>% filter(entity != "World") %>% filter(entity != "G20") %>% filter(entity != "OECD Countries") %>% filter(!grepl("World Bank ", entity)) %>% filter(!grepl("(WB)", entity)) %>% filter(!grepl("(WHO)", entity))

##############################################################
# impute missing hdi-data by linear regression
##############################################################
for(i in 1:nrow(tmp)) {
    tmp_mean <- OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity), ] %>% select(c(year, hdi)) 
    if ( !is.na(tmp_mean$hdi %>% mean(na.rm=TRUE)) ) {
        m <- lm(hdi ~ year, data=tmp_mean)
        OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$hdi) ), ]$hdi <- m$coefficients[1] + (m$coefficients[2]*OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$hdi) ), ]$year)
        rm(m, tmp_mean)
    }
}
rm(tmp)

##############################################################
# identify entities where gii is missing & put those in a temporary df, excluding multi-national entities
##############################################################
tmp <- OWID_gross_suicides[which(is.na(OWID_gross_suicides$gii)),  ] %>% select(c(entity, gii)) %>% unique()
tmp <- tmp %>% filter(!(entity %in% c("World", "G20", "OECD Countries"))) %>% filter(!grepl("World Bank ", entity)) %>% filter(!grepl("(WB)", entity)) %>% filter(!grepl("(WHO)", entity))

##############################################################
# impute missing gii-data by linear regression
##############################################################
for(i in 1:nrow(tmp)) {
    tmp_mean <- OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity), ] %>% select(c(year, gii)) 
    if ( !is.na(tmp_mean$gii %>% mean(na.rm=TRUE)) ) {
        m <- lm(gii ~ year, data=tmp_mean)
        OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$gii) ), ]$gii <- m$coefficients[1] + (m$coefficients[2]*OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$gii) ), ]$year)
        rm(m, tmp_mean)
    }
}
rm(tmp)

##############################################################
# identify entities where life_ladder, positive affect and negative_affect is missing & put those in a temporary df, excluding multi-national entities
##############################################################
tmp <- OWID_gross_suicides[which(is.na(OWID_gross_suicides$life_ladder)),  ] %>% select(c(entity, life_ladder)) %>% unique()
tmp <- tmp %>% filter(!(entity %in% c("World", "World Bank High Income", "World Bank Low Income", "World Bank Lower Middle Income", "World Bank Upper Middle Income"))) %>% filter(!grepl("(OECD)", entity)) %>% filter(!grepl("(WHO)", entity)) %>% filter(!grepl("(WB)", entity))

##############################################################
# impute missing life_ladder-data by linear regression
##############################################################
for(i in 1:nrow(tmp)) {
    tmp_mean <- OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity), ] %>% select(c(year, life_ladder)) 
    if ( !is.na(tmp_mean$life_ladder %>% mean(na.rm=TRUE)) ) {
        m <- lm(life_ladder ~ year, data=tmp_mean)
        OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$life_ladder) ), ]$life_ladder <- m$coefficients[1] + (m$coefficients[2]*OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$life_ladder) ), ]$year)
        rm(m, tmp_mean)
    }
}
##############################################################
# impute missing positive affect-data by linear regression
##############################################################
for(i in 1:nrow(tmp)) {
    tmp_mean <- OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity), ] %>% select(c(year, positive_affect)) 
    if ( !is.na(tmp_mean$positive_affect %>% mean(na.rm=TRUE)) ) {
        m <- lm(positive_affect ~ year, data=tmp_mean)
        OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$positive_affect) ), ]$positive_affect <- m$coefficients[1] + (m$coefficients[2]*OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$positive_affect) ), ]$year)
        rm(m, tmp_mean)
    }
}
##############################################################
# impute missing negative_affect-data by linear regression
##############################################################
for(i in 1:nrow(tmp)) {
    tmp_mean <- OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity), ] %>% select(c(year, negative_affect)) 
    if ( !is.na(tmp_mean$negative_affect %>% mean(na.rm=TRUE)) ) {
        m <- lm(negative_affect ~ year, data=tmp_mean)
        OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$negative_affect) ), ]$negative_affect <- m$coefficients[1] + (m$coefficients[2]*OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$negative_affect) ), ]$year)
        rm(m, tmp_mean)
    }
}
rm(tmp)

##############################################################
# identify entities where less_1_ratio, less_10_ratio, and gini is missing & put those in a temporary df, excluding multi-national entities
##############################################################
tmp <- OWID_gross_suicides[which(is.na(OWID_gross_suicides$gini)),  ] %>% select(c(entity, gini)) %>% unique()
tmp <- tmp %>% filter(!(entity %in% c("World", "World Bank High Income", "World Bank Low Income", "World Bank Lower Middle Income", "World Bank Upper Middle Income"))) %>% filter(!grepl("(OECD)", entity)) %>% filter(!grepl("(WHO)", entity)) %>% filter(!grepl("(WB)", entity))

##############################################################
# impute missing less_1_ratio-data by linear regression
##############################################################
for(i in 1:nrow(tmp)) {
    tmp_mean <- OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity), ] %>% select(c(year, less_1_ratio)) 
    if ( !is.na(tmp_mean$less_1_ratio %>% mean(na.rm=TRUE)) ) {
        m <- lm(less_1_ratio ~ year, data=tmp_mean)
        OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$less_1_ratio) ), ]$less_1_ratio <- m$coefficients[1] + (m$coefficients[2]*OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$less_1_ratio) ), ]$year)
        rm(m, tmp_mean)
    }
}
##############################################################
# impute missing less_10_ratio-data by linear regression
##############################################################
for(i in 1:nrow(tmp)) {
    tmp_mean <- OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity), ] %>% select(c(year, less_10_ratio)) 
    if ( !is.na(tmp_mean$less_10_ratio %>% mean(na.rm=TRUE)) ) {
        m <- lm(less_10_ratio ~ year, data=tmp_mean)
        OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$less_10_ratio) ), ]$less_10_ratio <- m$coefficients[1] + (m$coefficients[2]*OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$less_10_ratio) ), ]$year)
        rm(m, tmp_mean)
    }
}
##############################################################
# impute missing gini-data by linear regression
##############################################################
for(i in 1:nrow(tmp)) {
    tmp_mean <- OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity), ] %>% select(c(year, gini)) 
    if ( !is.na(tmp_mean$gini %>% mean(na.rm=TRUE)) ) {
        m <- lm(gini ~ year, data=tmp_mean)
        OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$gini) ), ]$gini <- m$coefficients[1] + (m$coefficients[2]*OWID_gross_suicides[which(OWID_gross_suicides$entity==tmp[i,]$entity & is.na(OWID_gross_suicides$gini) ), ]$year)
        rm(m, tmp_mean)
    }
}
rm(tmp)

# saveRDS(OWID_gross_suicides, "./OWID_gross_suicides.rds")
# save.image("./.RData")

OWID_gross_suicides_country <- OWID_gross_suicides_no_imputation %>% group_by(entity) %>% summarize (
age70plus                  = mean(age70plus                , na.rm=TRUE ),
age50_69                   = mean(age50_69                 , na.rm=TRUE ),
age15_49                   = mean(age15_49                 , na.rm=TRUE ),
age5_14                    = mean(age5_14                  , na.rm=TRUE ),
yearly_sum                 = 0                                           ,
population                 = mean(population               , na.rm=TRUE ),
m_population               = mean(m_population             , na.rm=TRUE ),
f_population               = mean(f_population             , na.rm=TRUE ),
popage65plus               = mean(popage65plus             , na.rm=TRUE ),
popage25to64               = mean(popage25to64             , na.rm=TRUE ),
popage15to24               = mean(popage15to24             , na.rm=TRUE ),
popage5to14                = mean(popage5to14              , na.rm=TRUE ),
popage0to4                 = mean(popage0to4               , na.rm=TRUE ),
f_suic_rate                = mean(f_suic_rate              , na.rm=TRUE ),
median_age                 = mean(median_age               , na.rm=TRUE ),
m_suic_rate                = mean(m_suic_rate              , na.rm=TRUE ),
mf_slfhrmdeath_age_stand   = mean(mf_slfhrmdeath_age_stand , na.rm=TRUE ),
mf_ipvioldeath_age_stand   = mean(mf_ipvioldeath_age_stand , na.rm=TRUE ),
suic_rate                  = mean(suic_rate                , na.rm=TRUE ),
mf_prev_md_s_ab_age_stand  = mean(mf_prev_md_s_ab_age_stand, na.rm=TRUE ),
m_prev_adhd                = mean(m_prev_adhd              , na.rm=TRUE ),
f_prev_adhd                = mean(f_prev_adhd              , na.rm=TRUE ),
m_prev_alco                = mean(m_prev_alco              , na.rm=TRUE ),
f_prev_alco                = mean(f_prev_alco              , na.rm=TRUE ),
m_prev_depr                = mean(m_prev_depr              , na.rm=TRUE ),
f_prev_depr                = mean(f_prev_depr              , na.rm=TRUE ),
m_prev_anxiety             = mean(m_prev_anxiety           , na.rm=TRUE ),
f_prev_anxiety             = mean(f_prev_anxiety           , na.rm=TRUE ),
m_prev_bipolar             = mean(m_prev_bipolar           , na.rm=TRUE ),
f_prev_bipolar             = mean(f_prev_bipolar           , na.rm=TRUE ),
m_prev_schizoph            = mean(m_prev_schizoph          , na.rm=TRUE ),
f_prev_schizoph            = mean(f_prev_schizoph          , na.rm=TRUE ),
hdi                        = mean(hdi                      , na.rm=TRUE ),
gii                        = mean(gii                      , na.rm=TRUE ),
gdppc                      = mean(gdppc                    , na.rm=TRUE ),
dollars_per_day            = mean(dollars_per_day          , na.rm=TRUE ),
less_1_ratio               = mean(less_1_ratio             , na.rm=TRUE ),
less_10_ratio              = mean(less_10_ratio            , na.rm=TRUE ),
gini                       = mean(gini                     , na.rm=TRUE ),
self_rep_trust             = mean(self_rep_trust           , na.rm=TRUE ),
all_veryimp                = mean(all_veryimp              , na.rm=TRUE ),
life_ladder                = mean(life_ladder              , na.rm=TRUE ),
positive_affect            = mean(positive_affect          , na.rm=TRUE ),
negative_affect            = mean(negative_affect          , na.rm=TRUE )) %>% mutate(yearly_sum = age70plus+age50_69+age15_49+age5_14)

#####################################################################################
# unload packages that are no longer needed
#####################################################################################
detach("package:owidR", unload = TRUE)
detach("package:pdftools", unload = TRUE)
detach("package:openxlsx", unload = TRUE)
detach("package:data.table", unload = TRUE)
```

So, for further analysis, I will restrict the time interval to consider to the range of **1990** to **2017**.

## Additional data sources

Besides the OWID-data other data sources have been used, as the data from these sources were more complete than those found in the OWID-web space.

Population data were collected from the web site of the [United Nations Population Division](https://population.un.org/wpp/Download/Files/1_Indicators%20(Standard)/EXCEL_FILES/1_General/WPP2022_GEN_F01_DEMOGRAPHIC_INDICATORS_COMPACT_REV1.xlsx). This site holds both historical data and future projections of multiple population related variables. In the present project *total* population, *male*, and *female* population, each as of July, 1st of each year were included.

Data on the *Human Development Index* were acquired from the web site of the [United Nations Human Development Reports](https://hdr.undp.org/data-center/human-development-index#/indicies/HDI). "The Human Development Index (HDI) is a summary measure of average achievement in key dimensions of human development: a long and healthy life, being knowledgeable and have a decent standard of living." [@nations] The HDI is a composite measure of a *health*-dimension, a *standard of living*-dimension, and an *education*-dimension.

Also included is the *Gender Inequality Index* ([GII](https://hdr.undp.org/content/measuring-key-disparities-human-development)) from the [same source](https://hdr.undp.org/sites/default/files/2021-22_HDR/HDR21-22_Composite_indices_complete_time_series.csv). This index encompasses measures of *reproductive health* (including maternal mortality ratio and adolescent birth rate), *empowerment* (e.g. share of women with at least secondary education) and the *labor* *market* (e.g. female labor force participation rate).

The Gross Domestic Product per capita is acquires from the [Maddison Project web site](https://www.rug.nl/ggdc/historicaldevelopment/maddison/releases/maddison-project-database-2020) of the Faculty of Economics and Business from Groningen/NL University [@bolt].

Though a measure of *People Living in Poverty* is [available](https://ourworldindata.org/grapher/poverty-vs-life-expectancy) from the OWID-website, a more complete data set is available via the OWID [github](https://github.com/owid/poverty-data). From this source the data on the percentage of people living on less than 1\$/day, and the percentage of people living on less than 10\$/day were extracted (both based on a 2017 purchasing power parity). From the same source the [*Gini*](https://en.wikipedia.org/wiki/Gini_coefficient) coefficient was extracted.

A measure of religious commitment (which might be of relevance to the rates of suicide) is available from [Pew Research](https://www.pewresearch.org/religion/2018/06/13/how-religious-commitment-varies-by-country-among-people-of-all-ages/). The relevant data can be found in the ["Complete Report"](https://www.pewresearch.org/religion/wp-content/uploads/sites/7/2018/06/ReligiousCommitment-FULL-WEB.pdf), from where the data had to be extracted using the $R$ `pdftools`-library.

Multinational data on people's *happiness* can be found in the [World Happiness Report](https://worldhappiness.report/ed/2022/). Levels of *happiness* might be of relevance to the analysis of suicidality. The relevant data are available from the web site of the World Happiness Report as a [spreadsheet](https://happiness-report.s3.amazonaws.com/2022/DataForTable2.1.xls)-file[^3]. The *happiness* is measured by means of a *life ladder*, where a rung *0* represents *the worst possible life*, and the rung *10* represents the *best possible life* for the informants on whose interviews the *happiness index* is based (see: [@cantril1965]). Typically around 1000 informants had been interviewed from each country in the database to determine the happiness index for the respective country.

[^3]: There is a difference between the happiness-data from [OWID](https://ourworldindata.org/grapher/happiness-cantril-ladder) and the data from the [WHR 22](https://happiness-report.s3.amazonaws.com/2022/DataForTable2.1.xls). OWID apparently uses the wrong *years*, as can be seen from the first rows of the resp. tables: `r rbind(c("Afghanistan", "AFG","2006", "3.72358989715576"," ", "Afghanistan", "2008", "3.72358989715576"),c("Afghanistan", "AFG","2007", "4.40177822113037"," ", "Afghanistan", "2009", "4.40177822113037"),c("Afghanistan", "AFG","2008", "4.75838088989258"," ", "Afghanistan", "2010", "4.75838088989258"),c("Afghanistan", "AFG","2009", "3.83171916007996"," ", "Afghanistan", "2011", "3.83171916007996")) %>%  as.data.frame() %>% kbl(col.names = c("Entity", "Code", "Year", "Life satisfaction in Cantril Ladder", " ", "Country name", "year", "Life Ladder")) %>% kable_minimal() %>% kable_styling(latex_options = "HOLD_position", full_width = F, font_size = 6, position = "left") %>% add_header_above(c("OWID" = 4, " " = 1, "WHR 22" = 3))`

Data on shares of expenditures for primary care physicians (who in many cases of suicidality are likely to be among the first to whom patients or their relatives turn to) are part of the the [WHO Global Health Expenditure Database](https://apps.who.int/nha/database). Unfortunately these data are too incomplete to be useful in the present analysis.

Some of the data are not covering the whole time span of the present analysis. E.g. for *Albania* the happiness- (*life-ladder*-) data are not available before *2007* and not for the year *2008*. To handle this, *imputations* of the missing values were calculated using *linear modeling*. This imputation was done with missing values from *HDI*, *GII*, *life ladder*, *positive affect*, *negative affect*, *less_1\_ratio*, *less_10_ratio*, and *gini* variables. However it is not known, if *linear modeling* in all these cases is an adequate method for imputation, this methodological question going beyond the scope of this paper.

For the purpose of analyzing the data on the level of *entities* (e.g. *nations*), while leaving the *years* out of consideration, a condensed data set was calculated holding the means of the relevant variables after grouping for entity.

## The data set for the present analysis

In figure \@ref(fig:WorldMapOWIDTotalSuicideNumbers) it could be seen that the data set compiled for the present analysis covers more regions of the world than the Kaggle data set did. However, the total number of suicides in a country over a certain period of time does not give a meaningful picture.

A better overall picture is obtained by measuring the total number of suicides against the population of the respective country. In the present analysis this is done by averaging the numbers of suicides per year and also the population of the countries over the observed time interval to calculate suicide mortality rates per 100,000 population.

```{r WorldMapOWIDTSuicidesPer100000, message=FALSE, echo=FALSE, fig.cap="map of OWID data on suicide rates / 100,000 population worldwide", out.width = "70%"}
##############################################################
# plot the world map data
##############################################################
world %>%
  merge(OWID_gross_suicides_rates, by.x = "region", by.y = "entity", all.x = T) %>%
  arrange(group, order) %>%
  ggplot(aes(x = long, y = lat, group = group, fill = avg_suicide_rate)) +
  geom_polygon(color = "gray90", size = 0.1) +
  scale_fill_viridis(name="suicides per\n100,000 popul.\nover entire\ntime-span\ncovered", option="H", begin=0.6, end=0.9, na.value = "white", labels = fancy_scientific, limits = c(0, 85)) +
  theme(aspect.ratio=0.6, axis.text = element_blank(), axis.title = element_blank())
```

At a first glance some countries and world regions apparently have quite high, while others have quite low rates of suicides. The question however is, how these differences might be explained. In the following it'll be tried to identify characteristics of countries that are related to either high or low suicide rates.

Before that can be done, it is useful to take a look at the data as they have been compiled for the present analysis. The following table \@ref(tab:currentVars) lists variable names and their meaning.

```{r currentVars, message=FALSE, echo=FALSE, collapse=TRUE}
vartab <- rbind(
c("entity"                       , "country, or group of countries"                                                                              ),
c("age70plus"                    , "suicides in the age group 70+ years"                                                                         ),
c("age50_69"                     , "suicides in the age group 50 to 69 years"                                                                    ),
c("age15_49"                     , "suicides in the age group 15 to 49 years"                                                                    ),
c("age5_14"                      , "suicides in the age group 5 to 14 years"                                                                     ),
c("yearly_sum"                   , "sum of suicides in the resp. year"                                                                           ),
c("population"                   , "population on July, 1st, from UN Population Division"                                                        ),
c("m_population"                 , "male population on July, 1st, from UN Population Division"                                                   ),
c("f_population"                 , "female population  on July, 1st, from UN Population Division"                                                ),
c("popage65plus"                 , "population of age 65+ on July, 1st, from UN Population Division"                                             ),
c("popage25to64"                 , "population of age between 24 and 64 on July, 1st, from UN Population Division"                               ),
c("popage15to24"                 , "population of age between 15 and 24 on July, 1st, from UN Population Division"                               ),
c("popage5to14"                  , "population of age between 5 and 14 on July, 1st, from UN Population Division"                                ),
c("popage0to4"                   , "population of age between 0 and 4 on July, 1st, from UN Population Division"                                 ),
c("median_age"                   , "population's median ag on July, 1st, from UN Population Division"                                            ),
c("m_suic_rate"                  , "male suicides per 100,000 population"                                                                        ),
c("f_suic_rate"                  , "female suicides per 100,000 population"                                                                      ),
c("suic_rate"                    , "overall suicides per 100,000 population"                                                                     ),
c("mf_slfhrmdeath_age_stand"     , "rate of deaths by self-harm, age-standradized"                                                               ),
c("mf_ipvioldeath_age_stand"     , "rate of detah from interpersonal violence, age-standradized"                                                 ),
c("mf_prev_md_s_ab_age_stand"    , "prevalence of mental diseases and substance use disorders, both sexes, age-standradized"                     ),
c("m_prev_adhd"                  , "prevalence of ADHD (males)"                                                                                  ),
c("f_prev_adhd"                  , "prevalence of ADHD (females)"                                                                                ),
c("m_prev_alco"                  , "prevalence of alcohol related disorders (males)"                                                             ),
c("f_prev_alco"                  , "prevalence of alcohol related disorders (females)"                                                           ),
c("m_prev_depr"                  , "prevalence of depressive disorders (males)"                                                                  ),
c("f_prev_depr"                  , "prevalence of depressive disorders (females)"                                                                ),
c("m_prev_anxiety"               , "prevalence of anxiety disorders (males)"                                                                     ),
c("f_prev_anxiety"               , "prevalence of anxiety disorders (females)"                                                                   ),
c("m_prev_bipolar"               , "prevalence of bipolar disorders (males)"                                                                     ),
c("f_prev_bipolar"               , "prevalence of bipolar disorders (females)"                                                                   ),
c("m_prev_schizoph"              , "prevalence of schizophrenia (males)"                                                                         ),
c("f_prev_schizoph"              , "prevalence of schizophrenia (females)"                                                                       ),
c("hdi"                          , "Human Development Index, from United Nations Human Development Reports"                                      ),
c("gii"                          , "Gender Inequality Index, United Nations Human Development Reports"                                           ),
c("gdppc"                        , "Gross Domestic Product per capita from the Maddison Project web site"                                        ),
c("dollars_per_day"              , "calulated by dividing gdppc by 365"                                                                          ),
c("less_1_ratio"                 , "precentage of population living in households with an income or expenditure per person below $1 a day"       ),
c("less_10_ratio"                , "percentage of population living in households with an income or expenditure per person below $10 a day"      ),
c("gini"                         , "measure of inequality between 0 and 1, with higher values indicating greater inequality"                     ),
c("self_rep_trust"               , "share of people agreeing with the statement “most people can be trusted”"                                    ),
c("all_veryimp"                  , "percentage of population who see religion as “very important” (all age groups)"                              ),
c("life_ladder"                  , "Cantril ladder value, from World Happiness Report 2022 (WHR22)"                                              ),
c("positive_affect"              , "laughter, enjoyment, and learning or doing something interesting on the previous day from WHR22"             ),
c("negative_affect"              , "worry, sadness, and anger on the previous day from WHR22"                                                    )
)
vartab %>% kbl(col.names = c("var label", "description"), caption = "variable names in the analysis data set and their descriptions", longtable = T, booktabs = T)  %>% kable_styling(latex_options = c("hold_position", "repeat_header"),bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left", repeat_header_continued = "\\textit{(Continued on Next Page...)}") %>% column_spec(1, width = "6.5cm", bold = TRUE) %>% column_spec(2, width = "9cm")
```

\newpage

# Results of clustering of suicide time-series {#clust-time-series}

The following figure \@ref(fig:TrendsSuicideRates) gives a first impression of the development of suicide rates over time. For this diagram the very small entities (e.g. *Antigua and Barbuda* with a population less than 100,000 people) were excluded. Among those small entities *Greenland* is a special case, as it started in 1990 with an excepionally high suicide rate of max. *`r round(OWID_gross_suicides_no_imputation[which(OWID_gross_suicides_no_imputation$suic_rate==(OWID_gross_suicides_no_imputation %>% filter(code=="GRL") %>% pull(suic_rate) %>% max())), ]$suic_rate, digits=2)`* in the year `r OWID_gross_suicides_no_imputation[which(OWID_gross_suicides_no_imputation$suic_rate==(OWID_gross_suicides_no_imputation %>% filter(code=="GRL") %>% pull(suic_rate) %>% max())), ]$year`, and a minimal rate of *`r round(OWID_gross_suicides_no_imputation[which(OWID_gross_suicides_no_imputation$suic_rate==(OWID_gross_suicides_no_imputation %>% filter(code=="GRL") %>% pull(suic_rate) %>% min())), ]$suic_rate, digits=2)`* in `r OWID_gross_suicides_no_imputation[which(OWID_gross_suicides_no_imputation$suic_rate==(OWID_gross_suicides_no_imputation %>% filter(code=="GRL") %>% pull(suic_rate) %>% min())), ]$year`. *Greenland's* suicide average rate from 1990 to 2017 of *`r round(OWID_gross_suicides_country %>% filter(entity=="Greenland") %>% pull(suic_rate), digits=2)`* is about 8 times higher than that of all countries averaged *except Greenland*, which is `r round(OWID_gross_suicides_country %>% filter(entity!="Greenland") %>% pull(suic_rate) %>% mean(), digits=2)`.

```{r TrendsSuicideRates, message=FALSE, echo=FALSE, collapse=TRUE, fig.cap="temporal development of rates of suicide per 100,000 population", out.width = "70%"}
##############################################################
# plot the trend lines for suicides in all countries except Greenland and multi-national entities, 
# and entities with a population less or equal to 100,000 (which might induce a bias)
##############################################################
OWID_gross_suicides_no_imputation %>% 
filter(!(entity %in% c("World", "G20", "OECD Countries"))) %>% filter(!grepl("World Bank ", entity)) %>% filter(!grepl("(WB)", entity)) %>% filter(!grepl("(WHO)", entity)) %>% filter(!is.na(suic_rate) & population >= 100000) %>% 
ggplot(aes(x=year, y=suic_rate)) + geom_line(aes(colour=code), show.legend = FALSE) + labs(x = "year", y = "suicide rate per 100,000 population")
```

From inspecting the graph a couple of things can be seen: (1) there seem to be a large proportion of entities in the lower range of *suicide rates* for which these rates seem to not change much, (2) there seem to be a handful of entities that show a *decrease in suicide rates*, partly with in intermediate *high*, (3) there also seem to be some entities in which an increase of *suicide rates* over time may be present. In the very low range there (4) also seems to exist entities for which ever other year a *zero*- or *close to zero*-value seems to have been reported, which might indicate so kind of reporting error.

Looking at a *violin plot* (fig. \@ref(fig:ViolinPlotOfSuicideRates)) of the suicide rates the marked asymmetry of the distribution of suicide-rates clearly can be seen. `r round((OWID_gross_suicides_country %>% filter(suic_rate <= (OWID_gross_suicides_country %>% pull(suic_rate) %>% describe() %>% .$mean)) %>% nrow()) / nrow(OWID_gross_suicides_country) * 100, digits=1)`% of reported suicide rates are below the average suicide rate of `r OWID_gross_suicides_country %>% pull(suic_rate) %>% describe() %>% .$mean` (with the median = `r round(OWID_gross_suicides_country %>% pull(suic_rate) %>% fivenum() %>% .[3], digits=2)`).

```{r ViolinPlotOfSuicideRates, message=FALSE, echo=FALSE, fig.cap="violin plot of suicide rates in different entities (> 100,000 population) ", out.width = "70%"}
##############################################################
# violin plot of suicide rates in all countries except entities with a population less or equal to 100,000
##############################################################
OWID_gross_suicides_country %>% filter(population >= 100000) %>% ggplot(aes(x=1, y=suic_rate)) + geom_violin(scale="area", fill="#FFCCCC")+ 
  stat_summary(fun = "mean", geom = "crossbar", width = 0.25, aes(color = "Mean")) +
  stat_summary(fun = "median", geom = "crossbar", width= 0.25, aes(color = "Median")) +
  scale_colour_manual(values = c("#0072B2", "#D55E00"), name = "") + 
  labs(y = "suicide rate per 100,000 population") + 
  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank())
```

The question now arises whether it is possible to group (cluster) the trajectories of suicide rates objectively in a meaningful way. Such grouping can be done according to the general trajectory of the curves, their shape or their level. Methods for clustering time series data have been discussed e.g. by [@warrenliao2005] or [@rani2012]. [@warrenliao2005] point out that an application of time-series clustering methods typically has to be preceded by some data preparation, e.g. to extract features, which then can be attempted to cluster.

## Is it possible to cluster the data?

```{r prepare_subset_of_data_for_clustering, message=FALSE, echo=FALSE}
cd <- OWID_gross_suicides_no_imputation %>% filter(!(entity %in% c("World", "G20", "OECD Countries"))) %>%
  filter(!grepl("World Bank ", entity)) %>% filter(!grepl("(WB)", entity)) %>% filter(!grepl("(WHO)", entity)) %>%
  filter(!is.na(suic_rate) & population >= 100000) %>% select(c(code,year,suic_rate)) %>%  
  group_by(code) %>% pivot_wider(names_from = year, values_from = suic_rate)                          # transform data into matrix cd (cluster data)
cd.c <- cd[complete.cases(cd), ]                                                                      # take only complete cases
```

This question can be answered by using the [Hopkins statistic](https://en.wikipedia.org/wiki/Hopkins_statistic). It measures the cluster tendency of some data, and tests whether the data are uniform or randomly distributed or if they are clustered. The Hopkins statistic can be calculated using the `hopkins` $R$-package. As the package's help-file states, a Hopkins statistic of **0.7** - **1.0** indicates, that data are clustered, and thus a cluster analysis is feasible.

For the *scaled* and *centered* set of complete suicide trend-lines a Hopkins statistic of **`r round(hopkins(scale(cd.c[, -1], center=T, scale=T) ), digits=1); detach("package:hopkins", unload = TRUE)`** is computed which indicates that a clustering of the data could work.

A visual inspection of the dissimilarity matrix confirms this: in figure \@ref(fig:DistanceMatrixOfCompleteData) there seems to be quite some non-randomness in the ordering of the data which is a precondition for them to be clustered.

```{r, DistanceMatrixOfCompleteData, echo=FALSE, message=FALSE, fig.cap="distance matrix of complete records showing non-randomness", out.width = "70%"}
fviz_dist(dist(scale(cd.c[, -1], center=T, scale=T)), show_labels = FALSE) + labs(title = "suicide: temporal trends")
```

## What clustering method is best?

$R$ provides a number of different functions for clustering. Frequently the *hierarchical* clustering, the *pam* clustering, and the *k-means* clustering methods are being used. Other clustering algorithms are **diana** (*divisive hierarchical clustering*), **clara** (*time-efficient clustering of large datasets*), or **fanny** (*fuzzy clustering*). The *clValid*-package [@clvalid:2008] allows for validating the results of a clustering analysis. The following paragraph shows the output of the *clValid()* function:

```{r, ExploringClValid, echo=FALSE, message=FALSE}
if(!require(RankAggreg)) install.packages("RankAggreg", repos = "http://cran.us.r-project.org")
library(RankAggreg)
clv <- clValid(scale(cd.c[, -1], center=T, scale=T), nClust=2:7, clMethods=c("hierarchical", "pam", "kmeans", "fanny"), validation="internal")
summary(clv) 
res <- getRanksWeights(clv)
CEWS <- RankAggreg(x=res$ranks, k=5, weights=res$weights, seed=123, verbose=FALSE)
```

From this analysis it seems that *hierarchical* and *pam* clustering methods are preferable. If in addition to this a ranking of the validation measures (using the `getRanksWeights()` and the `RankAggreg()` functions) is taken into account, then *k-means* also seems feasible.

```{r, message=FALSE, echo=FALSE}
CEWS
detach("package:RankAggreg", unload = TRUE)
```

So in the following all three of the above mentioned methods will be used.

In addition to this the $R$-package *TSclust* [@montero2015] will be used, which provides a wide set of dissimilarity measures between time series. These dissimilarity measures can then be used for clustering using model-free approaches, model-based approaches, complexity based approaches, and prediction-based approaches.

In the context of the current project the model-free approaches appear to be the most appropriate.

## Preparing the data for clustering

Feature scaling will be used using the [min-max normalization](https://en.wikipedia.org/wiki/Feature_scaling#Rescaling_(min-max_normalization)) and the [Z-standardization](https://en.wikipedia.org/wiki/Feature_scaling#Standardization_(Z-score_Normalization)) method.

Min-max normalization performs a linear transformation on the original data with the aim of getting all the scaled data into some range, typically between *zero* and *one*. This transformation is done by applying the formula

$$
x' = \frac{x - min(x)}{max(x) - min(x)}
$$

to each trend line. The transformation keeps both the trajectory and the shape of the original trend lines, while equalizing the different mean levels and ranges.

The standardization (Z-score Normalization) is done by applying the formula

$$
x' = \frac{x - \bar{x}}{\sigma}
$$

to each trend line, thus standardizing on a mean value of *zero* and a variance of *one*.

For the calculation of dissimilarity matrices and for the cluster analyses the data (using only *complete* cases) are transformed into a *wide* format such that each row represents a *entity*, and each column represents one *year*. To have a *"numeric-only"* matrix the first column (containing the country-codes) is being stripped. This information can be added later on for graphical presentation of the results (see following table \@ref(tab:DataInWideFormat)).

```{r prepare_cluster_trends_suicide_rates, message=FALSE, echo=FALSE}
##############################################################
# plot the min-max normalized trend lines for suicides in all countries except Greenland and multi-national entities, 
# and entities with a population less or equal to 100,000 (which might induce a bias)
##############################################################
nor <- function(x) { (x - min(x))/(max(x)-min(x)) }                                                   # function for min-max normalization
calc_wss <- function(df) sum(as.matrix(dist(df)^2)) / (2 * nrow(df))                                  # calculate within sum of squares for a matrix, see: https://stackoverflow.com/questions/54419329/calculate-total-sum-of-squares-between-clusters-in-r
cd.n <- cd.c[, -1]                                                                                    # strip of the column with the country code
cd.n <- t(apply(cd.n,1,nor))                                                                          # perform min-max normalization
cd.s <- t(apply(cd.c[, -1],1,scale))                                                                  # perform Z-normalization

wss <- calc_wss(cd.n)                                                                                 # calc within-sum-of-squares if no clustering is done, i.e.: number of clusters = 1
for (i in 2:10) wss[i] <- sum(kmeans(cd.n, centers=i)$withinss)                                       # an arbitrary max. number of cluster of 10 is set
##############################################################
# the "elbow"-plot based on Z-standradized scores is only marginally different from that based on min-max-normalization, and thus not included in the final report
##############################################################
# wss <- calc_wss(cd.s)
# for (i in 2:10) wss[i] <- sum(kmeans(cd.s, centers=i)$withinss)
##############################################################

cd.n.hclust <- as.data.frame(cd.n) 
rownames(cd.n.hclust) <- cd.c[complete.cases(cd.c), ]$code
h <- hclust(dist(abs(cor(na.omit(t(cd.n.hclust))))))
hclust.3.groups <- cutree(h, k = 3)
hclust.2.groups <- cutree(h, k = 2)
pamk.cd.n <- pamk(cd.n)$pamobject$clustering
pamk.cd.s <- pamk(cd.s)$pamobject$clustering
pam.cd.n <- pam(cd.n, 3)$clustering
```

```{r, DataInWideFormat, echo=FALSE, message=FALSE}
out <- head(round(cd.n[, 1:14], digits=2), 2)
kbl(out, caption = "partial view of suicide rates-data transformed into a wide format") %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = T, position = "left") 
```

The results of a first attempt at clustering the suicide trends using *hierarchical clustering* is shown in the next fig. \@ref(fig:HierarchicalClustering). This procedure[^4] yields rather unconclusive results, as to how many clusters should be extracted. From the graph a choice of both **two** or **three** clusters seems reasonable.

[^4]: The clustering based on *min-max normalization* and on *Z-standardization* lead to identical results, hence only the results of using min-max normalized data are presented here.

```{r, HierarchicalClustering, echo=FALSE, message=FALSE, fig.cap="hierarchical clustering of suicide trends", out.width = "65%"}
plot(h, cex = 0.40, main = "", xlab = "", sub = "") 
```

## Determining the optimal number of clusters to choose

### Elbow method

A frequently recommended procedure to determine the number of clusters to choose is the "elbow"-method, where an increasing number of clusters are extracted, and from a plot of the sum of squares against the number of clusters (fig. \@ref(fig:ElbowPlotOfClusters)) it can be seen where the slope of the plot turns from "steep" to "shallow" (the so-called "elbow")[^5]. Beyond this point the additional clusters do not add much to a meaningful ordering of the underlying variables. In the present case however a *two-cluster solution* seems favorable, as two clusters already extract more than 50 percent (`r round(wss[2]/wss[1]*100, digits=1)` %) of the total variance, although a *three-cluster solution* also seems applicable.

[^5]: Again, the results of *min-max normalization* and of *Z-standardization* lead to (in his case: almost) identical results, so only the results of using min-max normalized data are presented here.

```{r, ElbowPlotOfClusters, echo=FALSE, message=FALSE, fig.cap='"elbow"-plot of number of clusters to extract', out.width = "70%"}
plot(1:10, wss, type="b", xlab="number of Clusters", ylab="within groups sum of squares")
```

### Gap-Statistic

The *gap*-statistic estimates the number of clusters by taking the output of any clustering algorithm and compare the change in within-cluster dispersion with that expected under an appropriate reference null distribution [see: @tibshirani2001a]. A maximized *gap*-statistic indicates that the clustering structure is as far as possible from a random uniform distribution of measurement points.

In the present case the *gap*-statistic for up to 5 clusters using *k-means* (*pam* is almost identical) results in:

```{r, calc_gap_stat, echo=FALSE, message=FALSE}
gap.stat <- clusGap(cd.n, kmeans, 5)
gap.stat$Tab
```

A plot of the results (fig. \@ref(fig:QPlotGapStat)) reveals that using this technique a two-cluster solution appears to be the best, while a three-cluster solution also seems feasible, as it extracts even more variance without becoming too confusing.

```{r, QPlotGapStat, echo=FALSE, message=FALSE, fig.cap="Plot of gap-statistic showing that two clusters are best", out.width = "70%"}
qplot(1:nrow(gap.stat$Tab), gap.stat$Tab[, "gap"], xlab = "no. of clusters", ylab="gap", main="Estimating no. of clusters using gap-statistic", geom=c("line", "point")) + geom_errorbar(aes(1:nrow(gap.stat$Tab), ymin=gap.stat$Tab[, "gap"]-gap.stat$Tab[, "SE.sim"], ymax=gap.stat$Tab[, "gap"]+gap.stat$Tab[, "SE.sim"]), size=0.3, width=0.2)
```

### Partitioning around medoids (PAM)

The "elbow"-method being inexact and somewhat intuitive, there are other ways to determine the number of clusters to choose. One such method is *partitioning around medoids with estimation of number of clusters* (function `pamk()`) from the *fpc*-package. The method [@kaufman2009] aims at being a more robust (meaning: less sensitive to outliers) form of the k-means algorithm. *Medoids* can be understood as *centers of gravity*, where the data points are more grouped together and are more similar to each other [see: @manvailer]. Applying this procedure results in an estimated number of clusters of **`r numbers2words(pamk(cd.n)$nc)`**.

However, an inspection of the clusters shows a considerable overlap of the two clusters (fig. \@ref(fig:PAMCluster2Plot) and fig. \@ref(fig:PAMCluster2PlotEllipsis)). A silhouette plot (fig. \@ref(fig:PAMSilhouette2Plot)) of the clustering reveals that the two clusters are not vey well structured. According to the criteria proposed by Kaufman & Rousseeuw [-@kaufman2009] (to be found in @manvailer), a mean $S_i$-value between **0.26** and **0.50** indicates a weak cluster structure, which could be artificial. In the present case the mean silhouette-width $S_i$ is only **`r round(silhouette(pam(cd.n, 2, keep.diss = TRUE)) %>% as_tibble() %>% pull(sil_width) %>% mean() , digits=2)`**, which indicates a rather weak structure.

```{r, PAMCluster2Plot, echo=FALSE, message=FALSE, fig.cap='plot of clusters based on PAM', out.width = "70%"}
rownames(cd.n) <- cd.c[complete.cases(cd.c), ]$code
fviz_cluster(pam(cd.n, 2, keep.diss = TRUE), data = data, palette = c("#FC4E07", "#00AFBB"), ellipse.type = "euclid", star.plot = F, repel = T, ggtheme = theme_minimal() )
rownames(cd.n) <- 1:nrow(cd.n)
```

```{r, PAMCluster2PlotEllipsis, echo=FALSE, message=FALSE, fig.cap='plot of clusters based on PAM', out.width = "70%"}
# clusplot(pam(cd.n, 2), main="")
fviz_cluster(pam(cd.n, 2), ellipse.type="norm")
```

```{r, PAMSilhouette2Plot, echo=FALSE, message=FALSE, fig.cap='Silhouette-plot of clusters based on PAM', out.width = "70%"}
plot(silhouette(pam(cd.n, 2, keep.diss = TRUE)))
```

### Using the NbClust-package

An even more comprehensive routine for estimating the number of clusters is provided by the $R$ package *NbClust*. As ITS authors state, it "provides 30 indices which determine the number of clusters in a data set and it offers also the best clustering scheme from different results to the user" [@charrad2014]. The results of applying the `NbClust()`-function are presented below.

::: small
\small

```{r, NbClustPlotOfClusters, echo=FALSE, message=FALSE, warnings=FALSE, fig.cap="estimation of number of clusters using NbClust() ", out.width = "70%"}
if(!require(NbClust)) { install.packages("NbClust", repos = "http://cran.us.r-project.org") }
library(NbClust)
set.seed(1)
nbclust.cd.n <- NbClust(data = cd.n, distance = "euclidean",  method = "kmeans", index = "alllong", alphaBeale = 0.1)
```
:::

According to this the preferable number of clusters is **`r numbers2words(Mode(nbclust.cd.n$Best.nc[1, ]))`**.

```{r, unload_NbClust, echo=FALSE, message=FALSE, warnings=FALSE}
detach("package:NbClust", unload = TRUE)
```

In sum: There is no clear preference as to whether to extract **two** or **three** clusters. So, in the following it is proceeded with **three** clusters, as this choice will likely extract a bit more of the variance in the time-series data.

## Time-series clustering using *TSclust*

Besides the usual *pam* and *hierarchical* methods for time-series custering approaches given in the *TSclust* $R$-package were used. As Montero & Vilar [-@montero2015, p. 2] state, in time series "conventional distances between raw data (Euclidean or Manhattan, among others) evaluating a one-to-one mapping of each pair of sequences can produce satisfactory result". However there is "a wide range of dissimilarity measures to perform time series clustering" [@montero2015, p. 3] assembled in the *TSclust*-package from which the **COR**relation, the **EUC**lidean Distance, and the **DTWARP** (Dynamic Time Warping) were used in the present project. The following plot (fig. \@ref(fig:DoTimeSeriesClustering)) depicts the results of applying these procedures.

```{r, DoTimeSeriesClustering, echo=FALSE, message=FALSE, fig.width=6, fig.height=8.5, fig.cap="plots of time-series clustering using pam- and kmeans-methods"}
theme_set(theme_pubr())
pam.clus.cor <- pam(dist(diss(cd.n,"COR")), 3)
pam.clus.cor$data <- diss(cd.n,"COR")
pam.cor <- fviz_cluster(pam.clus.cor, geom = "point", main = "") 

pam.clus.euc <- pam(dist(diss(cd.n,"EUC")), 3)
pam.clus.euc$data <- diss(cd.n,"EUC")
pam.euc <- fviz_cluster(pam.clus.euc, geom = "point", main = "") 

pam.clus.dtw <- pam(dist(diss(cd.n,"DTWARP")), 3)
pam.clus.dtw$data <- diss(cd.n,"DTWARP")
pam.dtw <- fviz_cluster(pam.clus.dtw, geom = "point", main = "") 

set.seed(1)
kmeans.clus.cor <- kmeans(scale(diss(cd.n,"COR")), 3, nstart = 25)
kmeans.cor <- fviz_cluster(kmeans(scale(diss(cd.n,"COR")), 3, nstart = 25), data = diss(cd.n,"COR"), palette = c("#FE9F6F", "#00AFBB", "#E7B800"), geom = "point", ellipse.type = "convex", main = "")

set.seed(1)
kmeans.clus.euc <- kmeans(scale(diss(cd.n,"EUC")), 3, nstart = 25)
kmeans.euc <- fviz_cluster(kmeans(scale(diss(cd.n,"EUC")), 3, nstart = 25), data = diss(cd.n,"EUC"), palette = c("#FE9F6F", "#00AFBB", "#E7B800"), geom = "point", ellipse.type = "convex", main = "")

set.seed(1)
kmeans.clus.dtw <- kmeans(scale(diss(cd.n,"DTWARP")), 3, nstart = 25)
kmeans.dtw <- fviz_cluster(kmeans(scale(diss(cd.n,"DTWARP")), 3, nstart = 25), data = diss(cd.n,"DTWARP"), palette = c("#FE9F6F", "#00AFBB", "#E7B800"), geom = "point", ellipse.type = "convex", main = "")

ggarrange(pam.cor, kmeans.cor, pam.euc, kmeans.euc, pam.dtw, kmeans.dtw,
          labels = c("pam (cor)", "kmeans (cor)", "pam (euc)", "kmeans (euc)", "pam (dtwarp)", "kmeans (dtwarp)"),
          ncol = 2, nrow = 3)
```

In essence, the differences between *pam-* and *k-means-*clustering are not impressive. A more considerable difference exists between clustering with the *DTWARP-*method on the one hand and *COR-*, and *EUC-*methods on the other.

The question is, however, which is the preferable cluster solution?

Obviously the question of how to determine the validity of a clustering is not an easy one to answer. Different methods are discussed by Saitta et al. [-@saitta2008], Zhao et al[-@zhao2009] or Chouikhi et al. [-@chouikhi2015]. For the purpose of the present paper **only one measure** will be considered, the *within-cluster-sum-of-squares* (wcss). When clusters are "neat" and well separated it can be assumed that the *wcss* is minimized, as it indicates that the points within the clusters are *close* to each other.

The following table \@ref(tab:WCSSSummary) summarizes the findings concerning this matter. It shows that clustering using the *k-means* method, with the *euclidic* time-series distances computed using the *TSclust*-package is the best.

```{r WCSSSummary, echo=FALSE}
kbl(
 cbind(
  c(
   "hierarchical 3 clusters",
   "pam 3 clusters",
   "time-series (using TSclust) pam (cor, 3 clu.)",
   "time-series (using TSclust) pam (euc, 3 clu.)",
   "time-series (using TSclust) pam (dtwarp, 3 clu.)",
   "time-series (using TSclust) k-means (cor, 3 clu.)",
   "time-series (using TSclust) k-means (euc, 3 clu.)",
   "time-series (using TSclust) k-means (dtwarp, 3 clu.)"
  ),
  c(
   round(wcss(cd.n, hclust.3.groups)$WCSS, digits=2),
   round(wcss(cd.n, pam.cd.n)$WCSS, digits=2),
   round(wcss(cd.n, pam.clus.cor$clustering)$WCSS, digits=2),
   round(wcss(cd.n, pam.clus.euc$clustering)$WCSS, digits=2),
   round(wcss(cd.n, pam.clus.dtw$clustering)$WCSS, digits=2),
   round(wcss(cd.n, kmeans.clus.cor$cluster)$WCSS, digits=2),
   round(wcss(cd.n, kmeans.clus.euc$cluster)$WCSS, digits=2),
   round(wcss(cd.n, kmeans.clus.dtw$cluster)$WCSS, digits=2)
  )
 )
, booktabs = T, caption = "within cluster sum of squares", col.names=(c("clustering method", "wcss"))) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = c("striped", "condensed"), full_width = F, position = "left") %>% column_spec(1, width = "9.5cm") %>% column_spec(2, width = "4cm", bold = TRUE)
```

Using the results from this clustering procedure (clustering using the *k-means* method, with the *euclidic* time-series distances computed using the *TSclust*-package) the world map looks like in figure \@ref(fig:ClusteredWorldMap).

```{r ClusteredWorldMap, message=FALSE, echo=FALSE, fig.cap="map of countries assigned to results of cluster analysis", out.width = "80%"}
##############################################################
# plot the world map data with colors indicating to which cluster an entity belongs
##############################################################
world %>%
  merge(
  left_join( OWID_gross_suicides_rates, 
  (
  left_join(
    cbind((as_tibble(kmeans.clus.euc$cluster)%>%`colnames<-`("cluster")), 
           code=cd.c[complete.cases(cd.c), ]$code)
    ,  
    (OWID_gross_suicides %>% select(c(entity, code)) %>% unique()), 
  by = "code") %>% 
  select(c(entity, cluster))
  ), by = "entity")
  , 
  by.x = "region", by.y = "entity", all.x = T) %>%
  arrange(group, order) %>%
  ggplot(aes(x = long, y = lat, group = group, fill = factor(cluster))) +
  geom_polygon(color = "gray90", linewidth = 0.1) +
  scale_fill_manual(values=c("#FE9F6F", "#00AFBB", "#E7B800", "#E5E4E2"), name="Results of \nclustering", na.value = "#E5E4E2", labels=c("Cluster 1", "Cluster 2", "Cluster 3", "Cluster NA")) +
  theme(aspect.ratio=0.6, axis.line=element_blank(), axis.ticks=element_blank(), axis.text = element_blank(), axis.title = element_blank())
detach("package:viridis", unload = TRUE)
```

Undoubtedly these results are not very convincing. Intuitively there seems to be little that countries have in common like **USA**, **Libya** and **Moldavia** (which are all in Cluster 1), or **North Korea**, **Canada** and **Malawi** (which are all in Cluster 2). On the other hand, the clustering developed here shows agreement with a grouping of nations reported by Bertolote & Fleischmann [-@bertolote2002]: These authors observed a similarity of suicide rates in "Eastern Europe, in a group of countries that share similar historical and sociocultural characteristics, such as Estonia, Latvia, Lithuania and, to a lesser extent, Finland, Hungary and the Russian Federation", and "in the Eastern Mediterranean Region, which comprises mostly countries that follow Islamic traditions" [@bertolote2002, p. 181].

Reasons for this -- in spite of some agreement -- somewhat disappointing result might be (a) the fact that the time-series data on suicidality do not contain as much information as it could be hoped for, (b) the clustering methodology is not adequate for extracting information, that in fact *is* in the data, or (c) the primary collection of the data in the different countries suffers from methodological flaws, and is not sufficiently valid and reliable.

It might, however, be useful to try to relate data on suicidality to the other variables which had been gathered in the analysis data set.

\newpage

# Searching for determinants of suicidality

```{r SuicidalityDAG, message=FALSE, echo=FALSE, fig.cap="possible causal factors contributing to a resulting suicidality", , fig.width=8, fig.height=4.5, out.width = "80%"}
##############################################################
# Attempt at graphing factors that contribute to suicidality
##############################################################
set.seed(1)
if(!require(ggdag)) install.packages("ggdag", repos = "http://cran.us.r-project.org")
library(ggdag)
suic_dag <- dagify(suicide ~ choice,
				   choice ~ mental + livingconditions + values + sex + wellbeing,
				   values ~ relaffil,
				   # wellbeing ~ selfreptrust + lifeladder + posaffect + negaffect,
				   # mental ~ alc + depr + anx + bipol + schiz,
				   # socdev ~ hdi + gii + gini + socwealth, 
				   # socwealth ~ gdppc + less10ratio,
				   livingconditions ~ age + mental + socdev,
				   labels = c(mental = "clinical condition",
							  socdev = "societal development", 
							  wellbeing = "well-being", 
							  age = "age", 
							  relaffil = "religious affiliation", 
							  selfreptrust = "self reported trust", 
							  lifeladder = "happiness", 
							  posaffect = "enjoyment and laughter", 
							  negaffect = "worry, sadness, and anger",
							  hdi = "human development\nindex",
							  gii = "gender inequality\nindex", 
							  alc = "alcohol abuse",
							  depr = "depressive condition",
							  anx = "Aaxiety disorder",
							  bipol = "bipolar disorder",
							  schiz = "schizophrenia",
							  gini = "gini - index",
							  gdppc = "gross Domestic\nproduct per capita",
							  less10ratio = "ratio of people\nliving on < 10$ per day",
							  socwealth = "societal wealth", 
							  livingconditions = "living conditions",
							  values = "patient's values",
							  choice = "choice",
							  sex = "sex",
							  suicide = "SUICIDE"),
							  outcome = "suicide") %>% ggdag (text = F, use_labels = "label", edge_type= "link_arc", node_size = 6)
q <- ggplot_build(suic_dag)
q$data[[3]][8, ]$colour <- "red"
q$data[[4]][q$data[[4]]$label == "societal development", ]$y <- 3.2
q$data[[4]][q$data[[4]]$label == "living conditions", ]$x <- -0.2
q$data[[4]][q$data[[4]]$label == "patient's values", ]$y <- -1.5
q$data[[4]][q$data[[4]]$label == "clinical condition", ]$y <- 1
q$data[[4]][q$data[[4]]$label == "clinical condition", ]$x <- 0.75
q$data[[4]][q$data[[4]]$label == "choice", ]$x <- -1.05
q$data[[4]][q$data[[4]]$label == "choice", ]$y <- 0.65
q <- ggplot_gtable(q)
plot(q)	
detach("package:ggdag", unload = TRUE)
```

```{r BoxplotSuicidalityCountries, echo=FALSE, fig.width=10, fig.height=1.5, fig.cap="boxplot of rates of suicides per 100.000", out.width = "90%"}
qplot(OWID_gross_suicides_country$suic_rate, geom = "boxplot", notch=TRUE, ylab="", xlab="suicide rate")

OWID_gross_suicides_country <- OWID_gross_suicides_country %>% filter(entity!="Greenland")

mf1 <- OWID_gross_suicides_country %>% ggplot(aes(suic_rate, ((m_prev_adhd    /100*m_population)+(f_prev_adhd    /100*f_population))/population*100)) + geom_point(pch=4) + labs(x="both sexes suicide rate", y="prev. adhd"    ) + ylim(0, 6)  + xlim(0,70) + theme_classic()
mf2 <- OWID_gross_suicides_country %>% ggplot(aes(suic_rate, ((m_prev_alco    /100*m_population)+(f_prev_alco    /100*f_population))/population*100)) + geom_point(pch=4) + labs(x="both sexes suicide rate", y="prev. alco"    ) + ylim(0, 8)  + xlim(0,70) + theme_classic()
mf3 <- OWID_gross_suicides_country %>% ggplot(aes(suic_rate, ((m_prev_anxiety /100*m_population)+(f_prev_anxiety /100*f_population))/population*100)) + geom_point(pch=4) + labs(x="both sexes suicide rate", y="prev. anxiety" ) + ylim(0,11)  + xlim(0,70) + theme_classic()
mf4 <- OWID_gross_suicides_country %>% ggplot(aes(suic_rate, ((m_prev_depr    /100*m_population)+(f_prev_depr    /100*f_population))/population*100)) + geom_point(pch=4) + labs(x="both sexes suicide rate", y="prev. depr"    ) + ylim(0, 9)  + xlim(0,70) + theme_classic()
mf5 <- OWID_gross_suicides_country %>% ggplot(aes(suic_rate, ((m_prev_bipolar /100*m_population)+(f_prev_bipolar /100*f_population))/population*100)) + geom_point(pch=4) + labs(x="both sexes suicide rate", y="prev. bipolar" ) + ylim(0,1.8) + xlim(0,70) + theme_classic()
mf6 <- OWID_gross_suicides_country %>% ggplot(aes(suic_rate, ((m_prev_schizoph/100*m_population)+(f_prev_schizoph/100*f_population))/population*100)) + geom_point(pch=4) + labs(x="both sexes suicide rate", y="prev. schizoph") + ylim(.1,0.6)+ xlim(0,70) + theme_classic()

m1 <- OWID_gross_suicides_country %>% ggplot(aes(m_suic_rate, m_prev_adhd    )) + geom_point(pch=4) + labs(x="male suicide rate", y="") + ylim(0, 6)  + xlim(0,70) + theme_classic()
m2 <- OWID_gross_suicides_country %>% ggplot(aes(m_suic_rate, m_prev_alco    )) + geom_point(pch=4) + labs(x="male suicide rate", y="") + ylim(0, 8)  + xlim(0,70) + theme_classic()
m3 <- OWID_gross_suicides_country %>% ggplot(aes(m_suic_rate, m_prev_anxiety )) + geom_point(pch=4) + labs(x="male suicide rate", y="") + ylim(0,11)  + xlim(0,70) + theme_classic()
m4 <- OWID_gross_suicides_country %>% ggplot(aes(m_suic_rate, m_prev_depr    )) + geom_point(pch=4) + labs(x="male suicide rate", y="") + ylim(0, 9)  + xlim(0,70) + theme_classic()
m5 <- OWID_gross_suicides_country %>% ggplot(aes(m_suic_rate, m_prev_bipolar )) + geom_point(pch=4) + labs(x="male suicide rate", y="") + ylim(0,1.8) + xlim(0,70) + theme_classic()
m6 <- OWID_gross_suicides_country %>% ggplot(aes(m_suic_rate, m_prev_schizoph)) + geom_point(pch=4) + labs(x="male suicide rate", y="") + ylim(.1,0.6)+ xlim(0,70) + theme_classic()

f1 <- OWID_gross_suicides_country %>% ggplot(aes(f_suic_rate, f_prev_adhd    )) + geom_point(pch=4) + labs(x="female suicide rate", y="") + ylim(0, 6)  + xlim(0,70) + theme_classic() 
f2 <- OWID_gross_suicides_country %>% ggplot(aes(f_suic_rate, f_prev_alco    )) + geom_point(pch=4) + labs(x="female suicide rate", y="") + ylim(0, 8)  + xlim(0,70) + theme_classic() 
f3 <- OWID_gross_suicides_country %>% ggplot(aes(f_suic_rate, f_prev_anxiety )) + geom_point(pch=4) + labs(x="female suicide rate", y="") + ylim(0,11)  + xlim(0,70) + theme_classic() 
f4 <- OWID_gross_suicides_country %>% ggplot(aes(f_suic_rate, f_prev_depr    )) + geom_point(pch=4) + labs(x="female suicide rate", y="") + ylim(0, 9)  + xlim(0,70) + theme_classic() 
f5 <- OWID_gross_suicides_country %>% ggplot(aes(f_suic_rate, f_prev_bipolar )) + geom_point(pch=4) + labs(x="female suicide rate", y="") + ylim(0,1.8) + xlim(0,70) + theme_classic() 
f6 <- OWID_gross_suicides_country %>% ggplot(aes(f_suic_rate, f_prev_schizoph)) + geom_point(pch=4) + labs(x="female suicide rate", y="") + ylim(.1,0.6)+ xlim(0,70) + theme_classic() 

multiplot <- ggarrange(mf1, m1, f1, mf2, m2, f2, mf3, m3, f3, mf4, m4, f4, mf5, m5, f5, mf6, m6, f6, ncol = 3, nrow = 6)
```

Suicide results from a complex interplay of psychological, biogenetic, sociocultural, and existential variables [@pompili2010]. Within the scope of the present project, it will not be possible to do sufficient justice to this complexity. A preliminary attempt to summarize factors contributing to suicidality in a graph can be found in figure \@ref(fig:SuicidalityDAG). In the following at first bivariate relations between different variables and suicidality are examined, and then an attempt is made to develop a multivariate model of factors influencing suicidality.

## Suicidality and the sexes {#problemswithsexratio}

```{r, Suic_Male_Proportion, echo=FALSE, message=FALSE}
tmp <- OWID_gross_suicides_country %>% summarize(mean_m_rate = mean(m_suic_rate, na.rm=T), mean_f_rate = mean(f_suic_rate, na.rm =T)) %>%  as.numeric() 
```

In almost all (precisely, in *`r round(with (OWID_gross_suicides_country, (m_suic_rate > f_suic_rate) ) %>% mean(na.rm = T) * 100, digits=2)`%*) of the entities under consideration in the present project there is a higher suicide rate among *men* than among *women*. Over all world regions that are considered in this project on average the *male* suicide rate is **`r round(tmp[1] / tmp [2], digits = 2)`** times higher, than that of women. It can thus be assumed, that the overall rate of suicide in a society correlates with the *proportion of men* in the respective society's population.

```{r, SuicMaleProportion, echo=FALSE, message=FALSE, fig.cap="proportion of males in the population vs. the suicide rates", out.width = "80%"}
rm(tmp)
if(!require(ggrepel)) install.packages("ggrepel", repos = "http://cran.us.r-project.org")
library(ggrepel)
OWID_gross_suicides_country %>% mutate(maleproportion = m_population/population) %>% 
  ggplot(aes(suic_rate, maleproportion)) + geom_point() + 
    geom_label_repel(data= OWID_gross_suicides_country %>% mutate(maleproportion = m_population/population) %>% filter(maleproportion > 0.55),
   	  aes(label=entity)) + theme_bw()
detach("package:ggrepel", unload = TRUE)
```

However, as a plot of the proportion of males in the population *vs.* the suicide rates shows, there are some entities with a apparently abnormal high proportion of males (fig. \@ref(fig:SuicMaleProportion)). These entities, all of them from the *Arabian Peninsula* would likely introduce a bias when correlating *proportion of males* and *suicide rates*. Inasmuch as it is unlikely that the sex ratio in the Arabian Peninsula differs significantly from that in other parts of the world, it can be assumed that there are errors in data collection here. Therefore, the entities in question should be excluded from the data evaluation.

Even after the exclusion of this data from the evaluation there does not show up a *positive* relation between a population sex ratio that favors men and a higher suicide rate. Instead a *negative* correlation of $r$ = **`r tmp <- OWID_gross_suicides_country %>% mutate(maleproportion = m_population/population) %>% filter(maleproportion <= 0.55); round(cor.test(tmp$suic_rate, tmp$maleproportion, na.rm = T)$estimate, digits=2)`** , ($p$-*value = `r sprintf("%.2f", cor.test(tmp$suic_rate, tmp$maleproportion, na.rm = T)$p.value); rm(tmp)`*) can be observed, meaning that suicide rate appears to be *lower* in societies where the ratio of the sexes is tilted towards the *male* side.

## Suicidality and age factors

It is well known that the rates of suicide increase with age [@oconnell2004a]. This can also (tentatively) be found in the data set for the present analysis. The difficulty here is that the reported *suicides* $\times$ *age* groups are different from the *population* $\times$ *age* groups in the UN population data. In the former case the age groups are: *5 to14*, *15* to *49*, *50* to *69*, and *70+* years, in the latter case the age greoups are: *0* to *4*, *5* to *14*, *15* to *24*, *25* to *64*, and *65+*. Consequently the data from suicide rates by age and population-groups by age cannot be perfectly matched. The following table \@ref(tab:SuidicalityAgeGroups) thus gives only a rough estimate of the relation of suicide rates and age groups averaged over all entities and years under consideration, and of the total number of suicides over all years in all entities. The table also shows that the raw numbers (not the *rate*) of suicide is highest in the *younger* to *middle age* group, as this group constitutes the largest part of the world's population.

```{r SuidicalityAgeGroups, echo=FALSE, message=FALSE, warnings=FALSE}
tmp <- OWID_gross_suicides_country %>% select(c(entity, suic_rate, age5_14, age15_49, age50_69, age70plus, popage0to4, popage5to14, popage15to24, popage25to64, popage65plus)) %>% 
    mutate(srate5_14 = age5_14 / popage5to14, srate15_49 = age15_49 / (popage15to24+(0.62*popage25to64)), srate50_69 = age50_69 / (0.38*popage25to64), srate70plus = age70plus / popage65plus) %>% 
    summarize(srate5_14 = mean(srate5_14, na.rm = T), srate15_49 = mean(srate15_49, na.rm=T), srate50_69 = mean(srate50_69,na.rm=T), srate70plus = mean(srate70plus, na.rm=T)) %>% t() %>% as.data.frame()
tmp[, 1] <- tmp[, 1]*1e5
rownames(tmp) <- c("5 to 14", "15 to 49", "50 to 69", "70+")
tmp <- cbind(tmp, OWID_gross_suicides_country %>% select(c(age5_14, age15_49, age50_69, age70plus, popage0to4, popage5to14, popage15to24, popage25to64, popage65plus)) %>% summarize(age5_14 = sum(age5_14, na.rm=T), age15_49 = sum(age15_49, na.rm=T), age50_69 = sum(age50_69, na.rm=T), age70plus = sum(age70plus, na.rm=T)) %>% t())
names(tmp) <- c("suicide rate per 100.000", "total no. of suicides") 
tmp <- t(tmp)
tmp[2, ] <- sprintf("%i", round(tmp[2,]))
tmp[1, ] <- round(as.numeric(tmp[1, ]), digits=2)
kbl(tmp, booktabs = T, caption = "suicide rates and suicides in different age groups") %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, position = "left") 
rm(tmp)
```

The question of whether there is a relation between the suicide rates and the overall age structure can be answered using the *median age* of an entity's population. Calculating the *pearson*-correlation between these two measures results in $r$**=`r with(OWID_gross_suicides_country, round(cor.test(median_age, suic_rate)$estimate, digits=3))`** ($p$*=`r with(OWID_gross_suicides_country, sprintf("%.2f", cor.test(median_age, suic_rate)$p.value))`*) , which can be interpreted as indicating that approx. **`r with(OWID_gross_suicides_country, round(cor.test(median_age, suic_rate)$estimate^2*100))`%** of the *variance of the suicide rates* might be explained by the *median population age*.

## Suicidality and mental disorder

Suicide risk is related to depression and bipolar disorder [@sakinofsky2010], and schizophrenia [@meltzer2010], as well as to other mental illnesses. However, as can be seen from a table showing correlations between suicide rates and rates of mental illnesses on the entity (national) level, this doesn't shows up as clearly as expected in the data set for the present analysis (table \@ref(tab:SuicMentalCorr)). However as the box-plot in figure \@ref(fig:BoxplotSuicidalityCountries) shows there is one outlier with an exceptionally high suicide rate (*Greenland*), that will likely introduce some distortion into any correlation or regression. So *Greenland* had to be excluded from the further analyses (see chapter \@ref(clust-time-series)).

```{r SuicMentalCorr, echo=FALSE}
suic_mental_corr <- cbind(cbind(
  rbind(
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(((m_prev_adhd    /100*m_population)+(f_prev_adhd    /100*f_population))/population*100 , suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(((m_prev_adhd    /100*m_population)+(f_prev_adhd    /100*f_population))/population*100 , suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(((m_prev_alco    /100*m_population)+(f_prev_alco    /100*f_population))/population*100 , suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(((m_prev_alco    /100*m_population)+(f_prev_alco    /100*f_population))/population*100 , suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(((m_prev_anxiety /100*m_population)+(f_prev_anxiety /100*f_population))/population*100 , suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(((m_prev_anxiety /100*m_population)+(f_prev_anxiety /100*f_population))/population*100 , suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(((m_prev_depr    /100*m_population)+(f_prev_depr    /100*f_population))/population*100 , suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(((m_prev_depr    /100*m_population)+(f_prev_depr    /100*f_population))/population*100 , suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(((m_prev_bipolar /100*m_population)+(f_prev_bipolar /100*f_population))/population*100 , suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(((m_prev_bipolar /100*m_population)+(f_prev_bipolar /100*f_population))/population*100 , suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(((m_prev_schizoph/100*m_population)+(f_prev_schizoph/100*f_population))/population*100 , suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(((m_prev_schizoph/100*m_population)+(f_prev_schizoph/100*f_population))/population*100 , suic_rate)$p.value ))
  )
  ,
  rbind(
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(m_prev_adhd    /100*m_population, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(m_prev_adhd    /100*m_population, m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(m_prev_alco    /100*m_population, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(m_prev_alco    /100*m_population, m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(m_prev_anxiety /100*m_population, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(m_prev_anxiety /100*m_population, m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(m_prev_depr    /100*m_population, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(m_prev_depr    /100*m_population, m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(m_prev_bipolar /100*m_population, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(m_prev_bipolar /100*m_population, m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(m_prev_schizoph/100*m_population, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(m_prev_schizoph/100*m_population, m_suic_rate)$p.value ))
  )
 )
 , 
 rbind(
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(f_prev_adhd    /100*f_population, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(f_prev_adhd    /100*f_population, f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(f_prev_alco    /100*f_population, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(f_prev_alco    /100*f_population, f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(f_prev_anxiety /100*f_population, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(f_prev_anxiety /100*f_population, f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(f_prev_depr    /100*f_population, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(f_prev_depr    /100*f_population, f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(f_prev_bipolar /100*f_population, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(f_prev_bipolar /100*f_population, f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(f_prev_schizoph/100*f_population, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(f_prev_schizoph/100*f_population, f_suic_rate)$p.value ))
 )
) 
rownames(suic_mental_corr) <- c("prevalence  ADHD", "prevalence alcohol rel. dis.", "prevalence anxiety dis.", "prevalence depressive dis.", "prevalence bipolar dis.", "prevalence schizophrenia")
suic_mental_corr[,2] <- paste0("(", sprintf("%.2f", suic_mental_corr[,2]), ")")
suic_mental_corr[,4] <- paste0("(", sprintf("%.2f", suic_mental_corr[,4]), ")")
suic_mental_corr[,6] <- paste0("(", sprintf("%.2f", suic_mental_corr[,6]), ")")
suic_mental_corr[,1] <- round(suic_mental_corr[,1], digits=2)
suic_mental_corr[,3] <- round(suic_mental_corr[,3], digits=2)
suic_mental_corr[,5] <- round(suic_mental_corr[,5], digits=2)

kbl(suic_mental_corr, booktabs = T, caption = "correlations between suicide rates and rates of mental illnesses", align = "c") %>% add_header_above(c(" " = 1, "Both Sexes" = 2, "Males" = 2, "Females" = 2)) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, position = "left") %>% column_spec(3, italic = T) %>% column_spec(5, italic = T) %>% column_spec(7, italic = T) %>% column_spec(1, bold = T) %>% footnote(general = "r: Pearson correlation, p: two-sided p-value")
```

```{r, ShowMultiPlot, echo=FALSE, message=FALSE, fig.width=10, fig.height=14, fig.cap="scatter plots of suicide rates vs. prevalence of mental illnesses", out.width = "90%"}
print(multiplot)
rm(mf1, mf2, mf3, mf4, mf5, mf6, m1, m2, m3, m4, m5, m6, f1, f2, f3, f4, f5, f6) 
```

An inspection of the scatterplots of the correlations (see fig. \@ref(fig:ShowMultiPlot)) shows that in the majority of cases the correlations are low, maybe because of the overall low reported suicide rates. Also in the case of ADHD prevalence, bipolar prevalence, and schizophrenia prevalence, the charts give the impression that prevalences were recorded discontinuously in some cases, suggesting possible inadequacies in the collection of primary data.

## Suicidality and religious commitment

There seems to be a negative relation of *suicidality* and *importance of adherence to religious practice*, and this relation seems to be more prominent in men as can be seen from table \@ref(tab:SuicReligionCorr), meaning the higher on a societal level is the religious commitment, the lower are the rates of suicidality in this entity.

```{r SuicReligionCorr, echo=FALSE}
suic_relig_corr <- cbind(
 cbind(
  rbind(data.frame("r" = with(OWID_gross_suicides_country, cor.test(all_veryimp, suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(all_veryimp, suic_rate)$p.value ))),
  rbind(data.frame("r" = with(OWID_gross_suicides_country, cor.test(all_veryimp, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(all_veryimp, m_suic_rate)$p.value ))  )
 ),rbind(data.frame("r" = with(OWID_gross_suicides_country, cor.test(all_veryimp, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(all_veryimp, f_suic_rate)$p.value )) )
) 
rownames(suic_relig_corr) <- c("importance of religious practice")
suic_relig_corr[,2] <- paste0("(", sprintf("%.2f", suic_relig_corr[,2]), ")")
suic_relig_corr[,4] <- paste0("(", sprintf("%.2f", suic_relig_corr[,4]), ")")
suic_relig_corr[,6] <- paste0("(", sprintf("%.2f", suic_relig_corr[,6]), ")")
suic_relig_corr[,1] <- round(suic_relig_corr[,1], digits=2)
suic_relig_corr[,3] <- round(suic_relig_corr[,3], digits=2)
suic_relig_corr[,5] <- round(suic_relig_corr[,5], digits=2)

kbl(suic_relig_corr, booktabs = T, caption = "correlations between suicide rates and importance of religious affiliation", align = "c") %>% add_header_above(c(" " = 1, "Both Sexes" = 2, "Males" = 2, "Females" = 2)) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, position = "left") %>% column_spec(3, italic = T) %>% column_spec(5, italic = T) %>% column_spec(7, italic = T) %>% column_spec(1, bold = T) %>% footnote(general = "r: Pearson correlation, p: two-sided p-value")
```

## Suicidality and well-being

It can be assumed that suicidality is lower whenever and wherever the overall *psychological well-being* is higher. In the context of the present project *psychological well-being* can be seen as a function of an ability to have *trust* in other people, the degree to which one's own life is being seen as a good one on a "life ladder" ranging from *the worst* to *the best* possible life. Further contributions to psychological well-being might be the degree to which *positive* and *negative* affects are experienced, with *positive* affects presumably being related to lower suicidality and *negative* affects being related to higher suicidality.

```{r SuicWellBeingCorr, echo=FALSE}
suic_welbeing_corr <- cbind(cbind(
  rbind(
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(self_rep_trust,  suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(self_rep_trust,  suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(life_ladder,     suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(life_ladder,     suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(positive_affect, suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(positive_affect, suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(negative_affect, suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(negative_affect, suic_rate)$p.value ))
  )
  ,
  rbind(
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(self_rep_trust,  m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(self_rep_trust,  m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(life_ladder,     m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(life_ladder,     m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(positive_affect, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(positive_affect, m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(negative_affect, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(negative_affect, m_suic_rate)$p.value ))
  )
 )
 , 
 rbind(
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(self_rep_trust,  f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(self_rep_trust,  f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(life_ladder,     f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(life_ladder,     f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(positive_affect, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(positive_affect, f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(negative_affect, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(negative_affect, f_suic_rate)$p.value ))
 )
) 
rownames(suic_welbeing_corr) <- c("self-reported trust", "happines acc. to cantril ladder", "positive affect today or prev. day", "negative affect today or prev. day")
suic_welbeing_corr[,2] <- paste0("(", sprintf("%.2f", suic_welbeing_corr[,2]), ")")
suic_welbeing_corr[,4] <- paste0("(", sprintf("%.2f", suic_welbeing_corr[,4]), ")")
suic_welbeing_corr[,6] <- paste0("(", sprintf("%.2f", suic_welbeing_corr[,6]), ")")
suic_welbeing_corr[,1] <- round(suic_welbeing_corr[,1], digits=2)
suic_welbeing_corr[,3] <- round(suic_welbeing_corr[,3], digits=2)
suic_welbeing_corr[,5] <- round(suic_welbeing_corr[,5], digits=2)

kbl(suic_welbeing_corr, booktabs = T, caption = "correlations between suicide rates and psychological well-being", align = "c") %>% add_header_above(c(" " = 1, "Both Sexes" = 2, "Males" = 2, "Females" = 2)) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, position = "left") %>% column_spec(3, italic = T) %>% column_spec(5, italic = T) %>% column_spec(7, italic = T) %>% column_spec(1, bold = T) %>% footnote(general = "r: Pearson correlation, p: two-sided p-value")
```

Table \@ref(tab:SuicWellBeingCorr) shows bi-variate correlations of variables related to *psychological well-being* and suicidality. The presumed associations can only be found in part: the self-reported trust does not show a correlation with suicidality in men, and positive affect also does not seem to have a relation to suicidality in men and women. The relation of *happiness* to suicidality seems ambiguous, which may be the result of overall differences in suicidality rates between men and women, resulting in different trends in the association between happiness and suicidality in the two sexes (see: figure \@ref(fig:PlotPsychWellBeingSuic)).

```{r PlotPsychWellBeingSuic, echo=FALSE, fig.width=10, fig.height=2, fig.cap="psychological well-being in women, men, and both sexes combined", out.width = "90%"}
ggarrange(
(OWID_gross_suicides_country %>% ggplot(aes(  suic_rate, life_ladder)) + geom_point(pch=4) + labs(x="both sexes suicide rate", y="") + ylim(3.2, 8)  + xlim(0,70) + theme_classic()),
(OWID_gross_suicides_country %>% ggplot(aes(m_suic_rate, life_ladder)) + geom_point(pch=4) + labs(x="male suicide rate", y="")       + ylim(3.2, 8)  + xlim(0,70) + theme_classic()),
(OWID_gross_suicides_country %>% ggplot(aes(f_suic_rate, life_ladder)) + geom_point(pch=4) + labs(x="female suicide rate", y="")     + ylim(3.2, 8)  + xlim(0,70) + theme_classic()),
ncol = 3, nrow = 1)
```

## Suicidality and societal conditions {#societalconditions}

One might assume that under social conditions that offer little prospect of a healthy and satisfying life, the tendency to end one's own life is greater than in societies that promise better in this respect. In the context of the present project societal conditions are represented by the *Human Development Index* (HDI), the *Gender Ineqality Index* (GII), the *gross domestic product per capita*, the *GINI*-index, and the percentage of people living on *less than \$10 per day* (measured in 2011 Purchasing Power Parities).

The respective bi-variate associations can be seen in table \@ref(tab:SuicSocietalCorr) below.

```{r SuicSocietalCorr, echo=FALSE}
suic_societal_corr <- cbind(cbind(
  rbind(
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(hdi,           suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(hdi,           suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(gii,           suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gii,           suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(gdppc,         suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gdppc,         suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(less_10_ratio, suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(less_10_ratio, suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(gini,          suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gini,          suic_rate)$p.value ))
  )
  ,
  rbind(
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(hdi,           m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(hdi,           m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(gii,           m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gii,           m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(gdppc,         m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gdppc,         m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(less_10_ratio, m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(less_10_ratio, m_suic_rate)$p.value )),
  data.frame("r" = with(OWID_gross_suicides_country, cor.test(gini,          m_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gini,          m_suic_rate)$p.value ))
  )
 )
 , 
 rbind(
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(hdi,           f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(hdi,           f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(gii,           f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gii,           f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(gdppc,         f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gdppc,         f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(less_10_ratio, f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(less_10_ratio, f_suic_rate)$p.value )),
 data.frame("r" = with(OWID_gross_suicides_country, cor.test(gini,          f_suic_rate)$estimate ), "p" = with(OWID_gross_suicides_country, cor.test(gini,          f_suic_rate)$p.value ))
 )
) 
rownames(suic_societal_corr) <- c("Human Development Index", "Gender Inequality Index", "Gross Domestic Prod. per capita", "Percentage of people living on < $10 / day", "GINI-Index")
suic_societal_corr[,2] <- paste0("(", sprintf("%.2f", suic_societal_corr[,2]), ")")
suic_societal_corr[,4] <- paste0("(", sprintf("%.2f", suic_societal_corr[,4]), ")")
suic_societal_corr[,6] <- paste0("(", sprintf("%.2f", suic_societal_corr[,6]), ")")
suic_societal_corr[,1] <- round(suic_societal_corr[,1], digits=2)
suic_societal_corr[,3] <- round(suic_societal_corr[,3], digits=2)
suic_societal_corr[,5] <- round(suic_societal_corr[,5], digits=2)

kbl(suic_societal_corr, booktabs = T, caption = "correlations between suicide rates and societal factors", align = "c") %>% add_header_above(c(" " = 1, "Both Sexes" = 2, "Males" = 2, "Females" = 2)) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, position = "left") %>% column_spec(3, italic = T) %>% column_spec(5, italic = T) %>% column_spec(7, italic = T) %>% column_spec(1, bold = T) %>% footnote(general = "r: Pearson correlation, p: two-sided p-value")
```

Again, not all presumed associations can be found in the data. The *HDI* seems to be influential only in women (with a *higher* HDI being associated with *lower* suicidality), while -- surprisingly -- a lower *GII* does not seem to be beneficial to women in lowering their rate of suicides. Interestingly the *GDP per capita* appears to have little influence on suicide rates when looking at both sexes separately, while there being a positive and statistically significant relation, if both sexes are taken together. This again might be a result of a confounding effect of the gender variable with regard to suicide rates. The poverty index of *living in a household that has less the 10\$ available per day* is correlated inversely to the suicide rates if both sexes are taken together, which would mean that in a society, where the rate of poor people is higher, there would be a lower rate of suicides. The *GINI*-index apparently shows no association with suicide rates.

## Multivariate modeling of suicidality

In summary the results of the bivariate associations between various measures like sex, age, mental disorder, well-being, social measures, or religious commitment on the one hand, and suicide rates on the other seem somewhat equivocal and inconclusive.

It might be asked then, if a multivariate modeling (in this case: a *multiple regression*) of possible influences on suicidality could lead to further insights.

To perform a multiple regression first a data set performing this analysis had to be prepared, where prevalence for different mental illnesses which in the original data set had been reported separately for men and women were computed to reflect the prevalence in the total population (including both sexes). Then the gender specific prevalence rates were removed from the data. The sex ratio was computed as the rate of males in the entire population (with entities removed which had a male to female-ratio \> 0.55 as discussed in section \@ref(problemswithsexratio)). Other variables that would not be useful in the coomputation of a multiple regression were excluded as well. The remaining variables are:

```{r prepare-lm-data-set, echo=FALSE, message=FALSE, warnings=FALSE}
lmdataset <- OWID_gross_suicides_country %>% 
  mutate(maleproportion = m_population/population,
         prev_adhd     = ((m_prev_adhd    /100*m_population)+(f_prev_adhd    /100*f_population))/population*100,
         prev_alco     = ((m_prev_alco    /100*m_population)+(f_prev_alco    /100*f_population))/population*100, 
         prev_anxiety  = ((m_prev_anxiety /100*m_population)+(f_prev_anxiety /100*f_population))/population*100, 
         prev_depr     = ((m_prev_depr    /100*m_population)+(f_prev_depr    /100*f_population))/population*100, 
         prev_bipolar  = ((m_prev_bipolar /100*m_population)+(f_prev_bipolar /100*f_population))/population*100, 
         prev_schizoph = ((m_prev_schizoph/100*m_population)+(f_prev_schizoph/100*f_population))/population*100) %>% 
  dplyr::select(-c(entity, age70plus, age50_69, age15_49, age5_14, population, m_population, f_population, popage65plus, f_suic_rate, popage25to64, mf_prev_md_s_ab_age_stand, 
            popage15to24, popage5to14, popage0to4, yearly_sum, m_suic_rate, m_prev_adhd, f_prev_adhd, m_prev_alco, f_prev_alco, mf_slfhrmdeath_age_stand, 
            m_prev_depr, f_prev_depr, m_prev_anxiety, f_prev_anxiety, m_prev_bipolar, f_prev_bipolar, m_prev_schizoph, f_prev_schizoph, less_1_ratio)) %>% 
  filter(maleproportion <= 0.55)
if(!require(olsrr)) install.packages("olsrr", repos = "http://cran.us.r-project.org")
library(olsrr)
print(names(lmdataset))
```

For doing the multiple regression first a full model was taken with all possible predictors. Only complete rows were included, which might however limit the explanatory power of model (in effect only `r nrow(na.omit(lmdataset))` entities were included in the present calculation). As a next step all possible were computed using the function `ols_step_all_possible()` from the `olsrr`-package. From the result of this procedure the models with the **highest** *adjusted* $R^2$, and with the **lowest** *AIC* and *Mallow's CP* were selected. As this procedure is, however, quite highly time consuming, in the present report there are only included the final results of this calculation (in the accompanying $R$-source the relevant code is commented out, but can, of course, be run after deleting the comment-markings).

```{r define-full-model}
model <- lm(suic_rate ~ . , data = na.omit(lmdataset))
```

```{r select-the-model, echo=FALSE, message=FALSE, warnings=FALSE}
# following the prodecure that is shown in: https://www.youtube.com/watch?v=5K_7Pxmhzwg and https://www.youtube.com/watch?v=vFH--Xdt3Pk
##############################################################
# not run because maybe a little too time consuming
##############################################################
# k <- ols_step_all_possible(model)
# kmaxadjr <- k[which.max(k$adjr), ]
# kminaic  <- k[which.min(k$aic), ]
# kmincp   <- k[which.min(k$cp), ]
##############################################################
m6 <- lm(suic_rate ~ median_age + gii + all_veryimp + maleproportion + prev_alco + prev_bipolar, data = na.omit(lmdataset))
m8 <- lm(suic_rate ~ median_age + gii + all_veryimp + life_ladder + maleproportion + prev_alco + prev_bipolar + prev_schizoph, data = na.omit(lmdataset))
m10 <- ols_step_both_p(model, penter = 0.05, prem = 0.1) ## the results of this stepwise procedure are -- in a next step -- use for a lm()-function
m10 <- lm(formula = paste("suic_rate", "~", paste(m10$predictors, collapse = " + ")), data = na.omit(lmdataset))
```

In the present analysis the model with the *maximum adjusted* $R^2$, as well as with the *minimum AIC* had **eight** predictors: `lm(suic_rate ~ median_age + gii + all_veryimp + life_ladder + maleproportion + prev_alco + prev_bipolar + prev_schizoph, data = na.omit(lmdataset))`. The model with *minimum Mallow's CP* had **six** predictors: `lm(suic_rate ~ median_age + gii + all_veryimp + maleproportion + prev_alco + prev_bipolar, data = na.omit(lmdataset))`.

When finally doing a *stepwise* regression with the `ols_step_both_p()`-function, a model results with **ten** predictors: `m10 <- lm(suic_rate ~ all_veryimp + maleproportion + prev_bipolar + less_10_ratio + prev_alco + gii + prev_depr + median_age + life_ladder + prev_schizoph, data = na.omit(lmdataset))`.

The summary of the **six**-predictor model is:

```{r model_m6, echo=F, messages=F, warnings=F}
ols_regress(m6)
```

The summary of the **eight**-predictor model is:

```{r model_m8, echo=F, messages=F, warnings=F}
ols_regress(m8)
```

The summary of the **ten**-predictor model is:

```{r model_m10, echo=F, messages=F, warnings=F}
ols_regress(m10)
```

It is the understanding of the author of this report[^6] that all three models have some limitations, not only because of the large number of rows that were not included in the calculation because of missing values. All three are *statistically significant*, as can be seen from the respective ANOVAs. However in each of the models one or more individual predictors are *not* statistically significant (e.g. the *gender inequality index* in the six-predictors model or the *prevalence of schizophrenia* in the eight-predictors and ten-prdictors model).

[^6]: Obviously it takes quite some statistical knowledge and experience (which the author of this paper does only have to some limited extent) to skilfully conduct a complicated analysis like the one presented here. So please, bear with me ...

```{r do_ols_plots_resid_fit_spread, echo=FALSE, message=FALSE, warnings=FALSE}
if(!require(ggplotify)) install.packages("ggplotify", repos = "http://cran.us.r-project.org")
library(ggplotify)
if(!require(R.devices)) install.packages("R.devices", repos = "http://cran.us.r-project.org")
library(R.devices)
nulldev()
m6_resfitspreadplot  <- as.ggplot(ols_plot_resid_fit_spread(m6))  + labs(title= "6 predictor model") 
m8_resfitspreadplot  <- as.ggplot(ols_plot_resid_fit_spread(m8))  + labs(title= "8 predictor model") 
m10_resfitspreadplot <- as.ggplot(ols_plot_resid_fit_spread(m10)) + labs(title="10 predictor model") 

m6_residlevplot  <- as.ggplot(ols_plot_resid_lev(m6))  + labs(title= "6 predictors") 
m8_residlevplot  <- as.ggplot(ols_plot_resid_lev(m8))  + labs(title= "8 predictors") 
m10_residlevplot <- as.ggplot(ols_plot_resid_lev(m10)) + labs(title="10 predictors") 
dev.off()
```

```{r PlotsResidFit, echo=FALSE, message=FALSE, warnings=FALSE, fig.width=6, fig.height=8.5, fig.cap="plots of residuals and fits"}
ggarrange(m6_resfitspreadplot, m8_resfitspreadplot, m10_resfitspreadplot, ncol = 1, nrow = 3)
```

As shown in the plots of *fit* and *residuals* (see: fig. \@ref(fig:PlotsResidFit)) in all three models the spread of the residuals is larger than the spread of the centered fit, thus indicating a less that satisfactory modeling of the data. This is possibly the result of outliers, i.e. data rows that have a particularly strong influence on the model (see: fig. \@ref(fig:PlotsLeverage)).

```{r PlotsLeverage, echo=FALSE, message=FALSE, warnings=FALSE, fig.width=6, fig.height=8, fig.cap="plots of outliers and lerverage"}
ggarrange(m6_residlevplot, m8_residlevplot, m10_residlevplot, ncol = 2, nrow = 2)
```

In summary, notwithstanding the previously mentioned limitations, the results of the *multivariate modeling of suicidality* do show some interesting findings. As it could be expected from the previous research, the *median age* of an entity's population plays a role in predicting suicide rates. Also the *Gender Inequality Index* seems to be of quite some importance, as it was already reported in section \@ref(societalconditions) on the bi-variate influence of societal conditions.

\newpage

# Concluding Remarks

The present project gave [me](https://drhartkamp.de/) the opportunity to delve into the topic of suicidality from an epidemiological perspective, a topic with which I every now and then am confronted with from a more clinical point of view.

I could see that quite a plethora of data on a wide range of topics related to suicidality can be found on the net in different formats, and I had the chance to learn how to extract these for the present analysis.

At the same time I had to realize the limitations that are also there: for a number of regions of the world data are only fragmentary (maybe due to lack of regular reporting) or maybe even wrong (this might be the case in the reported sex ratio for nations from the Arabian peninsula).

I also had to realize that -- although the present Data Science course was exceptionally valuable -- for myself a whole lot is missing, particularly in the field of statistics as it comes to applying the more sophisticated methods of *cluster analysis* or *multiple regression* (and other methods as well).

In the end I am particularly grateful to all the people who contributed such extraordinary tools like $R$ or *RStudio* and all the tools and packages that I could use in this project. I remember well my first steps in medical statistics [cf: @davies-osterkamp1992], when it still was necessary to use eighty-column punch card, a pile of which was carried to the university computing center, only to get back a batch of fan-fold paper a couple of days later. How much easier is it today, and how much more fun!

\newpage

# References

::: {#refs}
:::

\newpage

# Appendix {#the-appendix}

## Sources of the OWID-data on suicide

### Suicide rate vs. death rate from violence

```{r, echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide rate vs. death rate from violence"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide rate vs. death rate from violence"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide rate vs. homicide rate

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide rate vs. homicide rate"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide rate vs. homicide rate"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide death rate vs. prevalence of mental & substance use disorders

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide death rate vs. prevalence of mental & substance use disorders"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide death rate vs. prevalence of mental & substance use disorders"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide rates vs. prevalence of depression

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide rates vs. prevalence of depression"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide rates vs. prevalence of depression"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Share of suicide deaths from pesticide poisoning

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Share of suicide deaths from pesticide poisoning"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Share of suicide deaths from pesticide poisoning"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Death rate from suicides

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Death rate from suicides"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Death rate from suicides"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Deaths from suicide, by age

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Deaths from suicide, by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Deaths from suicide, by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Male vs. female suicide rate

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Male vs. female suicide rate"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Male vs. female suicide rate"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Male-to-female ratio of suicide rates

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Male-to-female ratio of suicide rates"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Male-to-female ratio of suicide rates"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Number of suicide deaths from firearms

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Number of suicide deaths from firearms"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Number of suicide deaths from firearms"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Share of deaths from suicide

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Share of deaths from suicide"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Share of deaths from suicide"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide death rate by age

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide death rate by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide death rate by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[6]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[6]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide death rate by sex

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide death rate by sex"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide death rate by sex"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide death rates

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide death rates"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide death rates"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide rate

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide rate"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide rate"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide rate by firearm

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide rate by firearm"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide rate by firearm"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide rate in 1990 vs. 2019

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide rate in 1990 vs. 2019"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide rate in 1990 vs. 2019"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide rate vs. income inequality

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide rate vs. income inequality"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide rate vs. income inequality"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Suicide rates by age

```{r , echo=FALSE, warnings=FALSE}
headings <- owid_sources[which(owid_sources$title == "Suicide rates by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- owid_sources[which(owid_sources$title == "Suicide rates by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

## Topics of additional OWID-data related to the project

```{r otherOWIDTopics, echo=FALSE}
kbl(list_of_other_owid_tables$titles, booktabs = T, caption = "topics covered in additional OWID tables", col.names=("Topics")) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = c("striped", "condensed"), full_width = F, position = "left")
```

## Sources of the additional OWID-data related to the project

### Human Development Index vs. Corruption Perception Index

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Human Development Index vs. Corruption Perception Index"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Human Development Index vs. Corruption Perception Index"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Human Development Index vs. GDP per capita

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Human Development Index vs. GDP per capita"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Human Development Index vs. GDP per capita"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Gender Inequality Index from the Human Development Report

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Gender Inequality Index from the Human Development Report"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Gender Inequality Index from the Human Development Report"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position" ,bootstrap_options = "condensed", full_width = F, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Human Development Index

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Human Development Index"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Human Development Index"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Life expectancy vs. expected years lived with disability or disease

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Life expectancy vs. expected years lived with disability or disease"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Life expectancy vs. expected years lived with disability or disease"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Life expectancy vs. GDP per capita

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Life expectancy vs. GDP per capita"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Life expectancy vs. GDP per capita"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Inequality in life expectancy vs. health expenditure per capita

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Inequality in life expectancy vs. health expenditure per capita"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Inequality in life expectancy vs. health expenditure per capita"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Life expectancy vs. health expenditure

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Life expectancy vs. health expenditure"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Life expectancy vs. health expenditure"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Life expectancy vs. health expenditure per capita

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Life expectancy vs. health expenditure per capita"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Life expectancy vs. health expenditure per capita"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Life expectancy at birth, including the UN projections

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Life expectancy at birth, including the UN projections"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Life expectancy at birth, including the UN projections"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Population by broad age group, World

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Population by broad age group, World"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Population by broad age group, World"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Share in poverty vs. Life expectancy

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Share in poverty vs. Life expectancy"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Share in poverty vs. Life expectancy"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Life expectancy

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Life expectancy"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Life expectancy"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Life satisfaction vs. life expectancy

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Life satisfaction vs. life expectancy"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Life satisfaction vs. life expectancy"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Healthy life expectancy and years lived with disability

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Healthy life expectancy and years lived with disability"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Healthy life expectancy and years lived with disability"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of alcohol use disorders by age

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of alcohol use disorders by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of alcohol use disorders by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[6]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[6]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[7]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[7]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[8]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[8]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[9]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[9]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[10]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[10]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[11]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[11]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of alcohol use disorders in males vs. females

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of alcohol use disorders in males vs. females"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of alcohol use disorders in males vs. females"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Child mortality vs. Prevalence of child wasting

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Child mortality vs. Prevalence of child wasting"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Child mortality vs. Prevalence of child wasting"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Child mortality vs. Prevalence of stunting

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Child mortality vs. Prevalence of stunting"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Child mortality vs. Prevalence of stunting"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of ADHD in males vs females

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of ADHD in males vs females"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of ADHD in males vs females"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of anxiety disorders by age

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of anxiety disorders by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of anxiety disorders by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[6]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[6]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[7]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[7]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[8]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[8]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[9]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[9]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[10]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[10]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[11]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[11]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[12]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[12]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of anxiety disorders, males vs. females

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of anxiety disorders, males vs. females"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of anxiety disorders, males vs. females"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of bipolar disorder by age

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of bipolar disorder by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of bipolar disorder by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[6]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[6]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[7]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[7]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[8]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[8]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[9]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[9]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[10]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[10]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of bipolar disorder in males vs. females

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of bipolar disorder in males vs. females"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of bipolar disorder in males vs. females"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of depression by age

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of depression by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of depression by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[6]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[6]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[7]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[7]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[8]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[8]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[9]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[9]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[10]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[10]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of depression, males vs. females

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of depression, males vs. females"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of depression, males vs. females"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of eating disorders by age

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of eating disorders by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of eating disorders by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[6]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[6]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[7]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[7]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[8]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[8]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[9]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[9]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[10]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[10]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of schizophrenia by age

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of schizophrenia by age"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of schizophrenia by age"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[4]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[4]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[5]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[5]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[6]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[6]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[7]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[7]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[8]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[8]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[9]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[9]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[10]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[10]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[11]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[11]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Prevalence of schizophrenia in males vs. females

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Prevalence of schizophrenia in males vs. females"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Prevalence of schizophrenia in males vs. females"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Average years of schooling vs. GDP per capita

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Average years of schooling vs. GDP per capita"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Average years of schooling vs. GDP per capita"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### How important is God in your life? vs GDP per capita, 2014

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "How important is God in your life? vs GDP per capita, 2014"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "How important is God in your life? vs GDP per capita, 2014"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Self-reported life satisfaction, 2003 to 2020

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Self-reported life satisfaction, 2003 to 2020"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Self-reported life satisfaction, 2003 to 2020"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Happiness vs. life satisfaction, 2015

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Happiness vs. life satisfaction, 2015"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Happiness vs. life satisfaction, 2015"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`ir headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Civil liberties, 2021

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Civil liberties, 2021"),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Civil liberties, 2021"),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[2]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[2]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

[`r headings[3]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[3]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```

### Share of people agreeing with the statement "most people can be trusted"

```{r , echo=FALSE, warnings=FALSE}
headings <- other_owid_sources[which(other_owid_sources$title == "Share of people agreeing with the statement \"most people can be trusted\""),]$sources_content 
headings <- headings %>% minimal_html() %>% html_elements("h2") %>% html_text()
tables <- other_owid_sources[which(other_owid_sources$title == "Share of people agreeing with the statement \"most people can be trusted\""),]$sources_content 
tables <- tables %>% minimal_html() %>% html_table() 
for (i in 1:length(headings)) { names(tables[[i]]) <- c("Var", "Source") }
```

[`r headings[1]`]{.smallcaps}

```{r, echo=FALSE}
out<- tables[[1]]
kable(out) %>% kable_styling(latex_options = "HOLD_position",bootstrap_options = "condensed", full_width = F, font_size = 7, position = "left") %>% column_spec(1, width = "3.5cm") %>% column_spec(2, width = "12cm")
```
